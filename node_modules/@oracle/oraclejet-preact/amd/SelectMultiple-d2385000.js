define(["exports","preact/jsx-runtime","preact","preact/compat","./hooks/UNSAFE_useFocusableTextField","./hooks/UNSAFE_useFormContext","./hooks/UNSAFE_useFormFieldContext","./hooks/UNSAFE_useLoadingIndicatorTimer","./hooks/UNSAFE_useTextField","./UNSAFE_Flex","./UNSAFE_Label","./UNSAFE_LiveRegion","./UNSAFE_TextField","./UNSAFE_UserAssistance","./PRIVATE_SelectCommon","./tslib.es6-d8595453",'module',"./UNSAFE_Chip","./hooks/UNSAFE_useTranslationBundle","./Chip-6f1d81ad","preact/hooks","./utils/UNSAFE_mergeProps","./ReadonlyTextFieldInput-dc6c2c66","./TextFieldInput-33f53d8f","./Flex-b68a7b84"],function(e,n,o,s,t,i,l,a,r,d,u,c,p,v,b,f,h,F,m,w,x,y,g,S,D){"use strict";function A(e){var{accessibleLabel:o,count:s=0,onKeyDown:t,onKeyUp:i,onMouseDown:l}=e,a=f.__rest(e,["accessibleLabel","count","onKeyDown","onKeyUp","onMouseDown"]);const r=m.useTranslationBundle("@oracle/oraclejet-preact"),d=r.selectMultiple_showSelectedValues(),u=o?`${o}. `:"",c=r.selectMultiple_countPlus({COUNT:"99"}),p=s>99?`${c}`:`${s}`,v=`${u}${r.selectMultiple_valuesSelected({VALUE_COUNT:`${s}`})} ${d}`;return n.jsx("div",Object.assign({class:"_1stwyw0",onKeyDown:t,onKeyUp:i,onMouseDown:l},{children:n.jsx(w.Chip,Object.assign({accessibleLabel:v},a,{children:p}))}))}function E(e,n){const o=m.useTranslationBundle("@oracle/oraclejet-preact").plural_separator(),s=x.useMemo(()=>{if(void 0===n)return"";const s=function(e,n){const o=n?[...null==n?void 0:n.values()]:[],s=n=>b.renderItemText(n,e),t=o.map(s);return new Set(t)}(e,n),t=function(e,n){return Array.from(e.values()).join(n)}(s,o);return t},[n,e]);return s}function R({data:e,inputRef:n,isDisabled:o,isFocused:s,isReadonly:t,onCommit:i,onFilter:l,onLoadRange:a,valueItems:r}){const[d,u]=x.useState(!1),c=null==r?void 0:r.length,p=void 0!==c&&c>0||d,v=function({isDropdownSelectedOnlyView:e,valueItems:n}){return{data:x.useMemo(()=>{var o;return e&&n&&0!==n.length?{offset:0,totalSize:null!==(o=null==n?void 0:n.length)&&void 0!==o?o:0,sizePrecision:"exact",data:n.map(e=>{var n;return{data:e.data,metadata:null!==(n=e.metadata)&&void 0!==n?n:{key:e.key}}})}:void 0},[e]),onLoadRange:void 0}}({isDropdownSelectedOnlyView:d,valueItems:r}),f=d?v.data:e,h=d?v.onLoadRange:a,{currentRow:F,dropdownRef:m,handleDropdownArrowClick:w,handleDropdownAutoDismiss:g,handleDropdownPosition:S,handleInput:D,handleMainFieldKeyDown:A,handleMainFieldKeyUp:E,handleUpDownArrowKeys:R,isDropdownAbove:j,isDropdownOpen:C,isFocused:T,isUserFiltering:K,mainFieldRef:L,onCurrentKeyChange:U,onMouseDown:O,searchText:k,selectedKeys:P,setCurrentRow:_,setDropdownOpen:I,setSelectedKeys:M,userInput:N}=b.useSelectCommon({data:f,inputRef:n,isFocused:s,onFilter:l}),B=x.useCallback(()=>{var e,n;null===(n=null===(e=m.current)||void 0===e?void 0:e.parentElement)||void 0===n||n.removeChild(m.current)},[]),V=x.useCallback(e=>{var o,s;if(C&&"keydown"===(null==e?void 0:e.type)){const t=e;if(t.code===b.KEYS.TAB)t.shiftKey||!p?null===(o=n.current)||void 0===o||o.focus():null===(s=$.current)||void 0===s||s.focus(),B()}},[p,C]),z=x.useCallback(e=>{if(!b.isControlOrFunctionKey(e)&&e.code===b.KEYS.TAB)C&&(e.shiftKey||!p&&!e.shiftKey)&&(B(),I(!1)),p&&!e.shiftKey&&e.stopPropagation()},[p,C]);x.useEffect(()=>{const e=null==r?void 0:r.reduce((e,n)=>(e.add(n.key),e),new Set);M(e)},[r]);const $=x.useRef(null);x.useEffect(()=>{$.current=p&&L.current?L.current.querySelector('[role="switch"]'):null},[p,o,t]);const Y=x.useCallback(e=>{switch(e.code){case b.KEYS.TAB:C&&!e.shiftKey&&(B(),I(!1)),e.shiftKey&&e.stopPropagation();break;case b.KEYS.UP:case b.KEYS.DOWN:e.preventDefault();break;case b.KEYS.ESC:C&&(I(!1),e.preventDefault(),e.stopPropagation());break;case b.KEYS.ENTER:e.stopPropagation()}},[C]),H=x.useCallback(e=>{switch(e.code){case b.KEYS.UP:case b.KEYS.DOWN:R(e)}},[R]),q=x.useCallback(e=>{var o;e.preventDefault(),null===(o=n.current)||void 0===o||o.focus()},[]),W=x.useCallback(e=>{var n;C||I(!0);const o=null!==(n=e.value)&&void 0!==n&&n;o!==d&&u(o)},[C,d]);x.useEffect(()=>{!C&&d&&u(!1)},[C,d]);const Z=x.useCallback(e=>{var n;const o=new Set(null===(n=e.value.keys)||void 0===n?void 0:n.values());M(o),null==i||i({value:o,previousValue:P})},[i,P]),G=x.useMemo(()=>y.mergeProps({onAutoDismiss:g,onPosition:S},{onAutoDismiss:V}),[g,S,V]),J=x.useMemo(()=>y.mergeProps({onInput:D,onKeyDown:A,onKeyUp:E},{onKeyDown:z}),[A,D,E,z]);return x.useEffect(()=>{C&&_({rowKey:void 0})},[C]),{collectionProps:{currentKey:F.rowKey,onCurrentKeyChange:U,onSelectionChange:Z,selectedKeys:P},data:f,dropdownArrowEventHandlers:{onClick:w},dropdownEventHandlers:G,dropdownRef:m,hasSelectedValuesCount:p,inputEventHandlers:J,inputRef:n,isDropdownAbove:j,isDropdownOpen:C,isDropdownSelectedOnlyView:d,isFocused:T,isUserFiltering:K,mainFieldRef:L,mouseProps:o||t?{}:{onMouseDown:O},onLoadRange:h,searchText:k,selectedValuesCountProps:{onKeyDown:Y,onKeyUp:H,onMouseDown:q,onToggle:W},userInput:N}}const j=s.forwardRef(({ariaDescribedBy:e,assistiveText:s,data:d,helpSourceLink:f,helpSourceText:h,isDisabled:F,isLoading:w,isReadonly:x,isRequired:y,isRequiredShown:j,itemText:C,label:T,labelEdge:K,labelStartWidth:L,messages:U,onCommit:O,onFilter:k,onLoadRange:P,placeholder:_,textAlign:I,userAssistanceDensity:M,valueItems:N,variant:B="default",virtualKeyboard:V},z)=>{const{isDisabled:$,isReadonly:Y,labelEdge:H,labelStartWidth:q,textAlign:W,userAssistanceDensity:Z}=i.useFormContext(),G=null!=F?F:$,J=null!=x?x:Y,Q=null!=K?K:H,X=null!=L?L:q,ee=null!=I?I:W,ne=null!=M?M:Z,{enabledElementRef:oe,focusProps:se,isFocused:te,readonlyElementRef:ie}=t.useFocusableTextField({isDisabled:G,isReadonly:J,ref:z}),{collectionProps:le,data:ae,dropdownArrowEventHandlers:re,dropdownEventHandlers:de,dropdownRef:ue,hasSelectedValuesCount:ce,inputEventHandlers:pe,isDropdownAbove:ve,isDropdownOpen:be,isDropdownSelectedOnlyView:fe,isFocused:he,isUserFiltering:Fe,mainFieldRef:me,mouseProps:we,onLoadRange:xe,searchText:ye,selectedValuesCountProps:ge,userInput:Se}=R({data:d,inputRef:oe,isDisabled:G,isFocused:te,isReadonly:J,onCommit:O,onFilter:k,onLoadRange:P,valueItems:N}),De=a.useLoadingIndicatorTimer(null!=w&&w),{baseId:Ae,formFieldContext:Ee,inputProps:Re,labelProps:je,textFieldProps:Ce,userAssistanceProps:Te}=r.useTextField({ariaDescribedBy:e,isDisabled:G,isFocused:he,isLoading:De,isReadonly:J,labelEdge:Q,messages:U,styleVariant:B,value:void 0!==N&&N.length>0||void 0}),Ke=`${Ae}-dropdown`,Le=E(C,N),Ue="none"!==Q?n.jsx(u.Label,Object.assign({},je,{children:T})):void 0,Oe={label:"none"!==Q?Ue:void 0,labelEdge:"none"!==Q?Q:void 0,labelStartWidth:"none"!==Q?X:void 0},ke="none"===Q?T:void 0,Pe=G||J?"efficient"!==ne?void 0:n.jsx(v.InlineUserAssistance,Object.assign({userAssistanceDensity:ne},Te)):n.jsx(v.InlineUserAssistance,Object.assign({assistiveText:s,fieldLabel:T,helpSourceLink:f,helpSourceText:h,messages:U,isRequiredShown:j,userAssistanceDensity:ne},Te)),_e=m.useTranslationBundle("@oracle/oraclejet-preact");if(J)return n.jsx(l.FormFieldContext.Provider,Object.assign({value:Ee},{children:n.jsx(p.ReadonlyTextField,Object.assign({role:"presentation",inlineUserAssistance:Pe,onBlur:se.onfocusout,onFocus:se.onfocusin},Oe,{children:n.jsx(g.ReadonlyTextFieldInput,{ariaDescribedBy:e,ariaLabel:ke,ariaLabelledBy:je.id,as:"div",elementRef:ie,hasInsideLabel:void 0!==T&&"inside"===Q,textAlign:ee,value:Le})}))}));const Ie=null!=ae&&!b.isBeforeDataFetch(ae),Me=void 0!==Ue&&"inside"===Q,Ne=be&&Ie?0===(null==ae?void 0:ae.totalSize)?_e.select_noMatchesFound():1===(null==ae?void 0:ae.totalSize)?_e.select_oneMatchFound():"exact"===(null==ae?void 0:ae.sizePrecision)?_e.select_sizeMatchesFound({TOTAL_SIZE:`${null==ae?void 0:ae.totalSize}`}):_e.select_sizeOrMoreMatchesFound({TOTAL_SIZE:`${null==ae?void 0:ae.totalSize}`}):"",Be=n.jsxs(o.Fragment,{children:[n.jsx(S.TextFieldInput,Object.assign({ariaAutoComplete:"list",ariaControls:Ke,ariaExpanded:be,ariaLabel:ke,autoComplete:"off",hasInsideLabel:Me,inputRef:oe,isRequired:y},pe,{placeholder:_,role:"combobox",spellcheck:!1,textAlign:ee,type:b.isMobile()?"auto"===V?"search":V:void 0,value:Fe?Se:Le},Re)),n.jsx(c.LiveRegion,{children:Ne})]}),Ve=n.jsx(b.DropdownArrow,Object.assign({isDisabled:G,size:Me?"md":"sm"},re)),ze=null==N?void 0:N.length,$e=De?void 0:ce?n.jsxs(D.Flex,Object.assign({align:"center",justify:"center",gap:[0,"1x"]},{children:[n.jsx(A,Object.assign({accessibleLabel:T,count:ze,isDisabled:G,isSelected:fe},ge)),Ve]})):Ve,Ye=!be||ve||G||J||!s&&!f||"efficient"!==ne&&"reflow"!==ne?void 0:n.jsx(b.DropdownUserAssistance,{assistiveText:s,fieldLabel:T,helpSourceLink:f,helpSourceText:h,userAssistanceDensity:ne}),He=Ie&&0===(null==ae?void 0:ae.totalSize),qe=He?n.jsx(b.EmptyResults,{}):n.jsx(b.DefaultList,Object.assign({},le,{accessibleSummary:null!=T?T:"",data:ae,itemText:C,onLoadRange:xe,searchText:fe?void 0:Fe?ye:void 0,selectionMode:"multiple"}));return n.jsxs(o.Fragment,{children:[n.jsx(l.FormFieldContext.Provider,Object.assign({value:Ee},{children:n.jsx(p.TextField,Object.assign({endContent:$e,inlineUserAssistance:Pe,mainContent:Be,mainFieldRef:me,onBlur:null==se?void 0:se.onfocusout,onFocus:null==se?void 0:se.onfocusin},Ce,Oe,we))})),n.jsxs(b.Dropdown,Object.assign({dropdownRef:ue,id:Ke,isOpen:be&&void 0!==ae&&(null===ae||ae.totalSize>0||b.isBeforeDataFetch(ae)||He),anchorRef:me},de,{children:[n.jsx(b.DropdownList,Object.assign({hasBottomGap:void 0===Ye,isLoading:null===ae},{children:qe})),Ye]}))]})});e.SelectMultiple=j});
//# sourceMappingURL=SelectMultiple-d2385000.js.map
