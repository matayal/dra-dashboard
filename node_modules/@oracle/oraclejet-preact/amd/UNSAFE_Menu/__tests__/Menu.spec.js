define(["preact/jsx-runtime","preact/hooks","@testing-library/preact","@testing-library/user-event","chai","sinon","../../UNSAFE_Environment","../../UNSAFE_Button","../../utils/PRIVATE_clientHints","../../Menu-cb21d7c2","../../MenuItem-cedf713b","../../MenuDivider-54a56f1e","../../menuTestsUtils-c939f04d","../../Button-47193722","../../clientHints-0d38de57","preact","../../UNSAFE_Layer","preact/compat","../../UNSAFE_BaseButton","../../BaseButton-1b45961f","../../tslib.es6-d8595453","../../hooks/UNSAFE_usePress","../../hooks/UNSAFE_useHover","../../hooks/UNSAFE_useToggle","../../hooks/UNSAFE_useActive","../../utils/UNSAFE_classNames","../../classNames-b7cf3c05","css!./../../UNSAFE_Menu.css","../../utils/UNSAFE_interpolations/dimensions","../../utils/UNSAFE_arrayUtils","../../utils/UNSAFE_size","../../_curry1-67906f4c","../../utils/UNSAFE_mergeInterpolations","../../_curry3-9a7f6d78","../../_curry2-fc31d1f8","../../_has-83207242","../../hooks/UNSAFE_useTabbableMode","../../utils/UNSAFE_mergeProps","../../UNSAFE_Floating","../../Floating-2dad3061","../../index-8215ac99","../../hooks/UNSAFE_useUser","../../utils/PRIVATE_floatingUtils","../../utils/PRIVATE_refUtils","../../hooks/UNSAFE_useOutsideClick","../../hooks/PRIVATE_useCollectionFocusRing","../../useModal-221efa6e","../../UNSAFE_Text","../../Text-a22eae5d","../../hooks/UNSAFE_useId","../../UNSAFE_Divider","../../Divider-9022fb71"],function(e,t,n,s,o,l,i,u,a,c,r,m,d,p,y,f,x,g,E,h,M,I,v,A,w,k,b,j,F,_,q,U,S,R,B,N,T,D,C,L,K,P,H,O,V,X,Y,z,G,J,Q,W){"use strict";function Z(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var $=Z(s);const ee=({onClose:n,initialFocus:s="menu"})=>{const o=t.useRef(null);return e.jsxs(i.RootEnvironmentProvider,{children:[e.jsx(p.Button,{ref:o,label:"Press me"}),e.jsxs(c.Menu,Object.assign({isOpen:!0,anchorRef:o,accessibleLabel:"Test menu",onClose:n,initialFocus:s},{children:[e.jsx(r.MenuItem,{label:"MenuItem1"}),e.jsx(r.MenuItem,{label:"MenuItem2"}),e.jsx(m.MenuDivider,{}),e.jsx(r.MenuItem,{label:"MenuItem3"}),e.jsx(r.MenuItem,{label:"MenuItem4"})]}))]})};function te(){var e;return null===(e=document.activeElement)||void 0===e?void 0:e.dataset.ojMenuItemKey}describe("Test Menu Component",()=>{const{deviceType:t,hoverSupport:s}=y.getClientHints(),i="phone"===t,u="events"===s?3:4;beforeEach(()=>{d.setObserverConfig()}),it("Menu container render correctly",async function(){const t=n.render(e.jsx(ee,{})),s=d.getMenuItemByRole(t,"menu"),l=d.getAllMenuItemsByRole(t,"menuitem"),i=d.getAllMenuItemsByRole(t,"separator");o.expect(s).not.null,o.expect(s.classList.length).equals(2),o.expect(s.getAttribute("aria-label")).equals("Test menu"),o.expect(l.length).equals(4),o.expect(i.length).equals(1)}),it("onClose called when Escape or Tab are pressed",async function(){const t=l.spy(),s=n.render(e.jsx(ee,{onClose:t})),u=d.getMenuItemByRole(s,"menu");o.expect(u).not.null,i||(n.fireEvent.keyDown(u,{key:"Tab"}),n.fireEvent.keyDown(u,{key:"Escape"}),o.expect(t.calledTwice).to.be.true)}),it("onClose called when clicking outside",async function(){var t;const s=l.spy(),u=n.render(e.jsx(ee,{onClose:s})),a=d.getMenuItemByRole(u,"menu"),c=d.getLabel(u,"Press me");if(o.expect(a).not.null,i){const e=null===(t=a.parentElement)||void 0===t?void 0:t.parentElement;e&&$.default.click(e)}else $.default.click(c);o.expect(s.called).to.be.true}),it("onClose called when item was clicked",async function(){const t=l.spy(),s=n.render(e.jsx(ee,{onClose:t})),i=d.getMenuItemByRole(s,"menu"),u=d.getAllMenuItemsByRole(s,"menuitem")[0];o.expect(i).not.null,n.fireEvent.click(u),o.expect(t.called).to.be.true}),it("onClose called when swipe is done (mobile)",async function(){const t=l.spy(),s=n.render(e.jsx(ee,{onClose:t})),u=d.getMenuItemByRole(s,"menu");if(o.expect(u).not.null,"undefined"==typeof jest&&i){const e=u.parentElement,s=new Touch({target:e,identifier:0,pageX:386,pageY:224}),l=new Touch({target:e,identifier:0,pageX:389,pageY:397});e&&(n.fireEvent.touchStart(e,{timeStamp:10406,currentTarget:e,changedTouches:[s]}),n.fireEvent.touchEnd(e,{timeStamp:10472,currentTarget:e,changedTouches:[l]})),o.expect(t.called).to.be.true}}),it("Focus when item is clicked",async function(){const t=n.render(e.jsx(ee,{})),s=d.getMenuItemByRole(t,"menu"),l=d.getAllMenuItemsByRole(t,"menuitem"),i=l[2].dataset.ojMenuItemKey;o.expect(s).not.null,"undefined"!=typeof jest&&(await n.waitFor(()=>{o.expect(document.activeElement).equals(s)},{timeout:100}),$.default.click(l[2]),o.expect(te()).equals(i),o.expect(l[2].classList.length).equals(u-1))}),it("Focus on firstItem when initialFocus is set as firstItem",async function(){const t=n.render(e.jsx(ee,{initialFocus:"firstItem"})),s=d.getMenuItemByRole(t,"menu"),l=d.getAllMenuItemsByRole(t,"menuitem"),i=l[0].dataset.ojMenuItemKey;o.expect(s).not.null,"undefined"!=typeof jest&&(o.expect(te()).equals(i),o.expect(l[0].classList.length).equals(u))}),it("Menu Keyboard navigation - focus",async function(){const t=n.render(e.jsx(ee,{})),s=d.getMenuItemByRole(t,"menu"),l=d.getAllMenuItemsByRole(t,"menuitem"),i=l[0].dataset.ojMenuItemKey,a=l[1].dataset.ojMenuItemKey,c=l[2].dataset.ojMenuItemKey,r=l[3].dataset.ojMenuItemKey;o.expect(s).not.null,"undefined"!=typeof jest&&(await n.waitFor(()=>{o.expect(document.activeElement).equals(s)},{timeout:100}),n.fireEvent.keyDown(s,{key:"ArrowDown"}),o.expect(te()).equals(i),o.expect(l[0].classList.length).equals(u),n.fireEvent.keyDown(s,{key:"ArrowDown"}),o.expect(te()).equals(a),o.expect(l[1].classList.length).equals(u),n.fireEvent.keyDown(s,{key:"ArrowDown"}),o.expect(te()).equals(c),o.expect(l[2].classList.length).equals(u),n.fireEvent.keyDown(s,{key:"ArrowDown"}),o.expect(te()).equals(r),o.expect(l[3].classList.length).equals(u),n.fireEvent.keyDown(s,{key:"ArrowDown"}),o.expect(te()).equals(i),o.expect(l[0].classList.length).equals(u),n.fireEvent.keyDown(s,{key:"ArrowUp"}),o.expect(te()).equals(r),o.expect(l[3].classList.length).equals(u))}),it("Menu Keyboard navigation - focus with Home and End",async function(){const t=n.render(e.jsx(ee,{})),s=d.getMenuItemByRole(t,"menu"),l=d.getAllMenuItemsByRole(t,"menuitem"),i=l[0].dataset.ojMenuItemKey,a=l[3].dataset.ojMenuItemKey;o.expect(s).not.null,"undefined"!=typeof jest&&(await n.waitFor(()=>{o.expect(document.activeElement).equals(s)},{timeout:100}),n.fireEvent.keyDown(s,{key:"End"}),o.expect(te()).equals(a),o.expect(l[3].classList.length).equals(u),n.fireEvent.keyDown(s,{key:"Home"}),o.expect(te()).equals(i),o.expect(l[0].classList.length).equals(u))})})});
//# sourceMappingURL=Menu.spec.js.map
