{"version":3,"file":"SelectMultipleMenuGroup.spec.js","sources":["../../../../src/UNSAFE_Menu/SelectMultipleMenuGroup.tsx","../../../../src/UNSAFE_Menu/__tests__/SelectMultipleMenuGroup.spec.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ComponentChildren } from 'preact';\n\nimport { MenuValueUpdateDetail } from './menuUtils';\nimport { SelectMenuGroupContext } from './SelectMenuGroupContext';\n\ntype SelectMultipleMenuGroupProps = {\n  children: ComponentChildren;\n  value?: string[];\n  onCommit?: (detail: MenuValueUpdateDetail<string[]>) => void;\n};\n\nexport function SelectMultipleMenuGroup({\n  value,\n  onCommit,\n  children\n}: SelectMultipleMenuGroupProps) {\n  return (\n    <SelectMenuGroupContext.Provider value={{ isMultiple: true, value, onCommit }}>\n      {children}\n    </SelectMenuGroupContext.Provider>\n  );\n}\n","import { useState, useRef } from 'preact/hooks';\nimport { render, fireEvent } from '@testing-library/preact';\n\nimport { expect } from 'chai';\nimport { spy } from 'sinon';\n\nimport { Button } from '../../UNSAFE_Button';\n\nimport { Menu } from '../Menu';\nimport { SelectMenuItem } from '../SelectMenuItem';\nimport { SelectMultipleMenuGroup } from '../SelectMultipleMenuGroup';\nimport { RootEnvironmentProvider } from '../../UNSAFE_Environment';\nimport { MenuValueUpdateDetail } from '../menuUtils';\nimport { getIcon, setObserverConfig, getAllMenuItemsByRole } from './menuTestsUtils';\n\nconst SelectMenu = ({\n  initialValue,\n  onCommit\n}: {\n  initialValue?: string[];\n  onCommit?: (detail: MenuValueUpdateDetail<string[]>) => void;\n}) => {\n  const [selectMultipleValue, setSelectMultipleValue] = useState(initialValue);\n\n  const handleCommit = ({ value }: MenuValueUpdateDetail<string[]>) => {\n    setSelectMultipleValue(value);\n  };\n\n  const ref = useRef(null);\n\n  return (\n    <>\n      <RootEnvironmentProvider>\n        <Button ref={ref} label=\"Text Wrapping\" />\n        <Menu isOpen={true} anchorRef={ref}>\n          <SelectMultipleMenuGroup value={selectMultipleValue} onCommit={onCommit || handleCommit}>\n            <SelectMenuItem value=\"bold\" label=\"Bold\"></SelectMenuItem>\n            <SelectMenuItem value=\"italics\" label=\"Italics\"></SelectMenuItem>\n            <SelectMenuItem value=\"underline\" label=\"Undeline\"></SelectMenuItem>\n          </SelectMultipleMenuGroup>\n        </Menu>\n      </RootEnvironmentProvider>\n    </>\n  );\n};\n\ndescribe('Test Menu Component', () => {\n  beforeEach(() => {\n    setObserverConfig();\n  });\n\n  it('onCommit called when selecting item', async function () {\n    const dummyFunc = spy();\n    const content = render(<SelectMenu onCommit={dummyFunc} />);\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n    fireEvent.click(menuItems[0]);\n\n    expect(dummyFunc.calledOnce).to.be.true;\n  });\n\n  it('Initial SelectMultipleMenuGroup render without value', async function () {\n    const content = render(<SelectMenu />);\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n\n    const firstItem = menuItems[0];\n    const secondItem = menuItems[1];\n    const thirdItem = menuItems[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(firstItem, 'svg')).null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(secondItem, 'svg')).null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n\n  it('Initial SelectMultipleMenuGroup render with value', async function () {\n    const content = render(<SelectMenu initialValue={['bold']} />);\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n\n    const firstItem = menuItems[0];\n    const secondItem = menuItems[1];\n    const thirdItem = menuItems[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('true');\n    expect(getIcon(firstItem, 'svg')).not.null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(secondItem, 'svg')).null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n\n  it('SelectMultipleMenuGroup changes if selected item is selected again', async function () {\n    const content = render(<SelectMenu initialValue={['bold']} />);\n\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n    fireEvent.click(menuItems[0]);\n\n    const menuItemsAfterClick = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n\n    const firstItem = menuItemsAfterClick[0];\n    const secondItem = menuItemsAfterClick[1];\n    const thirdItem = menuItemsAfterClick[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(firstItem, 'svg')).null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(secondItem, 'svg')).null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n\n  it('SelectMultipleMenuGroup selected item changes when selecting it', async function () {\n    const content = render(<SelectMenu initialValue={['bold']} />);\n\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n    fireEvent.click(menuItems[1]);\n\n    const menuItemsAfterClick = getAllMenuItemsByRole(content, 'menuitemcheckbox');\n\n    const firstItem = menuItemsAfterClick[0];\n    const secondItem = menuItemsAfterClick[1];\n    const thirdItem = menuItemsAfterClick[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('true');\n    expect(getIcon(firstItem, 'svg')).not.null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('true');\n    expect(getIcon(secondItem, 'svg')).not.null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n});\n"],"names":["SelectMultipleMenuGroup","value","onCommit","children","_jsx","SelectMenuGroupContext","Provider","Object","assign","isMultiple","SelectMenu","initialValue","selectMultipleValue","setSelectMultipleValue","useState","ref","useRef","_Fragment","_jsxs","jsxs","RootEnvironmentProvider","Button","label","Menu","isOpen","anchorRef","jsx","SelectMenuItem","describe","beforeEach","setObserverConfig","it","async","dummyFunc","spy","content","render","menuItems","getAllMenuItemsByRole","fireEvent","click","expect","calledOnce","to","be","true","firstItem","secondItem","thirdItem","not","null","getAttribute","equals","getIcon","menuItemsAfterClick"],"mappings":"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"}