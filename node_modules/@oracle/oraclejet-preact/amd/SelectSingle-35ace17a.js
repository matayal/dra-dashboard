define(["exports","preact/jsx-runtime","preact","preact/compat","./hooks/UNSAFE_useFocusableTextField","./hooks/UNSAFE_useFormContext","./hooks/UNSAFE_useFormFieldContext","./hooks/UNSAFE_useLoadingIndicatorTimer","./hooks/UNSAFE_useTextField","./UNSAFE_Label","./UNSAFE_LiveRegion","./UNSAFE_TextField","./UNSAFE_UserAssistance","./PRIVATE_SelectCommon","preact/hooks","./utils/UNSAFE_mergeProps","./hooks/UNSAFE_useTranslationBundle","./ReadonlyTextFieldInput-dc6c2c66","./TextFieldInput-33f53d8f"],function(e,o,n,s,i,t,l,a,r,d,u,c,v,p,F,m,f,h,b){"use strict";const x=s.forwardRef(({ariaDescribedBy:e,assistiveText:s,data:x,helpSourceLink:w,helpSourceText:y,isDisabled:g,isLoading:S,isReadonly:A,isRequired:R,isRequiredShown:D,itemText:E,label:T,labelEdge:C,labelStartWidth:j,messages:k,onCommit:K,onFilter:I,onLoadRange:L,placeholder:U,textAlign:O,userAssistanceDensity:P,valueItem:_,variant:M="default",virtualKeyboard:B},N)=>{const{isDisabled:z,isReadonly:H,labelEdge:q,labelStartWidth:V,textAlign:W,userAssistanceDensity:Y}=t.useFormContext(),$=null!=g?g:z,Z=null!=A?A:H,G=null!=C?C:q,J=null!=j?j:V,Q=null!=O?O:W,X=null!=P?P:Y,{enabledElementRef:ee,focusProps:oe,isFocused:ne,readonlyElementRef:se}=i.useFocusableTextField({isDisabled:$,isReadonly:Z,ref:N}),{collectionProps:ie,dropdownArrowEventHandlers:te,dropdownEventHandlers:le,dropdownRef:ae,inputEventHandlers:re,isDropdownAbove:de,isDropdownOpen:ue,isFocused:ce,isUserFiltering:ve,mainFieldRef:pe,mouseProps:Fe,searchText:me,userInput:fe}=function({data:e,inputRef:o,isDisabled:n,isFocused:s,isReadonly:i,onCommit:t,onFilter:l,valueItem:a}){const{currentRow:r,dropdownRef:d,handleDropdownArrowClick:u,handleDropdownAutoDismiss:c,handleDropdownPosition:v,handleInput:f,handleMainFieldKeyDown:h,handleMainFieldKeyUp:b,isDropdownAbove:x,isDropdownOpen:w,isFocused:y,isUserFiltering:g,mainFieldRef:S,onCurrentKeyChange:A,onMouseDown:R,searchText:D,selectedKeys:E,setCurrentRow:T,setDropdownOpen:C,setSelectedKeys:j,stopFiltering:k,userInput:K}=p.useSelectCommon({data:e,inputRef:o,isFocused:s,onFilter:l}),I=F.useRef(e),L=F.useRef(w),U=F.useRef(D),O=F.useCallback(e=>{null==t||t({value:e,previousValue:void 0!==a?a.key:void 0})},[t,a]),P=F.useCallback(()=>{C(!1),j(new Set),O(void 0)},[O]),_=F.useCallback(()=>!(!g||""!==K||void 0===a||(P(),0)),[P,g,K,a]);F.useEffect(()=>{y||_()},[y]);const M=F.useCallback(()=>{var e;null===(e=o.current)||void 0===e||e.focus()},[]),B=F.useCallback(()=>{var e,o;null===(o=null===(e=d.current)||void 0===e?void 0:e.parentElement)||void 0===o||o.removeChild(d.current)},[]),N=F.useCallback(e=>{w&&"keydown"===(null==e?void 0:e.type)&&e.code===p.KEYS.TAB&&(void 0!==r&&void 0!==r.rowKey&&(j(new Set([r.rowKey])),O(r.rowKey)),M(),B())},[r,M,w,O]),z=F.useCallback(o=>{var n,s;if(!p.isControlOrFunctionKey(o))switch(o.code){case p.KEYS.TAB:!_()&&w&&null!=e&&e.data.length>0&&(void 0!==r&&void 0!==r.rowKey?(j(new Set([r.rowKey])),O(r.rowKey)):O(null!==(n=null==a?void 0:a.key)&&void 0!==n?n:void 0)),B(),C(!1);break;case p.KEYS.ENTER:!_()&&w&&null!=e&&e.data.length>0&&(C(!1),k(),void 0!==r&&void 0!==r.rowKey?(j(new Set([r.rowKey])),O(r.rowKey)):O(null!==(s=null==a?void 0:a.key)&&void 0!==s?s:void 0))}},[_,r,e,w,O,a]);F.useEffect(()=>{j(void 0===a?void 0:new Set([a.key]))},[a]);const H=F.useCallback(e=>{M(),C(!1),k();const o=e.context.metadata.key;j(new Set([o])),O(o)},[M,O]);F.useEffect(()=>{e!==I.current&&w&&g&&null!=e&&0===e.offset&&e.data.length>0&&T({rowKey:void 0!==D&&(null==D?void 0:D.length)>0?e.data[0].metadata.key:void 0})},[e,w,g,D]),F.useEffect(()=>{w!==L.current&&(!w||g&&void 0!==D&&0!==D.length||T({rowKey:void 0}))},[w,g,D]);const q=F.useMemo(()=>m.mergeProps({onAutoDismiss:c,onPosition:v},{onAutoDismiss:N}),[c,v,N]),V=F.useMemo(()=>m.mergeProps({onInput:f,onKeyDown:h,onKeyUp:b},{onKeyDown:z}),[h,f,b,z]);return F.useEffect(()=>{I.current=e,L.current=w,U.current=D}),{collectionProps:{currentKey:r.rowKey,onCurrentKeyChange:A,onItemAction:H,selectedKeys:E},dropdownArrowEventHandlers:{onClick:u},dropdownEventHandlers:q,dropdownRef:d,inputEventHandlers:V,inputRef:o,isDropdownAbove:x,isDropdownOpen:w,isFocused:y,isUserFiltering:g,mainFieldRef:S,mouseProps:n||i?{}:{onMouseDown:R},searchText:D,userInput:K}}({data:x,inputRef:ee,isDisabled:$,isFocused:ne,isReadonly:Z,onCommit:K,onFilter:I,valueItem:_}),he=a.useLoadingIndicatorTimer(null!=S&&S),{baseId:be,formFieldContext:xe,inputProps:we,labelProps:ye,textFieldProps:ge,userAssistanceProps:Se}=r.useTextField({ariaDescribedBy:e,isDisabled:$,isFocused:ce,isLoading:he,isReadonly:Z,labelEdge:G,messages:k,styleVariant:M,value:void 0!==_||void 0}),Ae=`${be}-dropdown`,Re=function(e,o){return F.useMemo(()=>{var n;return void 0===o?"":null!==(n=p.renderItemText(o,e))&&void 0!==n?n:""},[o,e])}(E,_),De="none"!==G?o.jsx(d.Label,Object.assign({},ye,{children:T})):void 0,Ee={label:"none"!==G?De:void 0,labelEdge:"none"!==G?G:void 0,labelStartWidth:"none"!==G?J:void 0},Te="none"===G?T:void 0,Ce=$||Z?"efficient"!==X?void 0:o.jsx(v.InlineUserAssistance,Object.assign({userAssistanceDensity:X},Se)):o.jsx(v.InlineUserAssistance,Object.assign({assistiveText:s,fieldLabel:T,helpSourceLink:w,helpSourceText:y,messages:k,isRequiredShown:D,userAssistanceDensity:X},Se)),je=f.useTranslationBundle("@oracle/oraclejet-preact");if(Z)return o.jsx(l.FormFieldContext.Provider,Object.assign({value:xe},{children:o.jsx(c.ReadonlyTextField,Object.assign({role:"presentation",inlineUserAssistance:Ce,onBlur:oe.onfocusout,onFocus:oe.onfocusin},Ee,{children:o.jsx(h.ReadonlyTextFieldInput,{ariaDescribedBy:e,ariaLabel:Te,ariaLabelledBy:ye.id,as:"div",elementRef:se,hasInsideLabel:void 0!==T&&"inside"===G,textAlign:Q,value:Re})}))}));const ke=null!=x&&!p.isBeforeDataFetch(x),Ke=void 0!==De&&"inside"===G,Ie=ue&&ke?0===(null==x?void 0:x.totalSize)?je.select_noMatchesFound():1===(null==x?void 0:x.totalSize)?je.select_oneMatchFound():"exact"===(null==x?void 0:x.sizePrecision)?je.select_sizeMatchesFound({TOTAL_SIZE:`${null==x?void 0:x.totalSize}`}):je.select_sizeOrMoreMatchesFound({TOTAL_SIZE:`${null==x?void 0:x.totalSize}`}):"",Le=o.jsxs(n.Fragment,{children:[o.jsx(b.TextFieldInput,Object.assign({ariaAutoComplete:"list",ariaControls:Ae,ariaExpanded:ue,ariaLabel:Te,autoComplete:"off",hasInsideLabel:Ke,inputRef:ee,isRequired:R},re,{placeholder:U,role:"combobox",spellcheck:!1,textAlign:Q,type:p.isMobile()?"auto"===B?"search":B:void 0,value:ve?fe:Re},we)),o.jsx(u.LiveRegion,{children:Ie})]}),Ue=o.jsx(p.DropdownArrow,Object.assign({isDisabled:$,size:Ke?"md":"sm"},te)),Oe=!ue||de||$||Z||!s&&!w||"efficient"!==X&&"reflow"!==X?void 0:o.jsx(p.DropdownUserAssistance,{assistiveText:s,fieldLabel:T,helpSourceLink:w,helpSourceText:y,userAssistanceDensity:X}),Pe=ke&&0===(null==x?void 0:x.totalSize),_e=Pe?o.jsx(p.EmptyResults,{}):o.jsx(p.DefaultList,Object.assign({},ie,{accessibleSummary:null!=T?T:"",currentItemVariant:"highlight",data:x,itemText:E,onLoadRange:L,searchText:ve?me:void 0,selectionMode:"single"}));return o.jsxs(n.Fragment,{children:[o.jsx(l.FormFieldContext.Provider,Object.assign({value:xe},{children:o.jsx(c.TextField,Object.assign({endContent:he?void 0:Ue,inlineUserAssistance:Ce,mainContent:Le,mainFieldRef:pe,onBlur:null==oe?void 0:oe.onfocusout,onFocus:null==oe?void 0:oe.onfocusin},ge,Ee,Fe))})),o.jsxs(p.Dropdown,Object.assign({dropdownRef:ae,id:Ae,isOpen:ue&&void 0!==x&&(null===x||x.totalSize>0||p.isBeforeDataFetch(x)||Pe),anchorRef:pe},le,{children:[o.jsx(p.DropdownList,Object.assign({hasBottomGap:void 0===Oe,isLoading:null===x},{children:_e})),Oe]}))]})});e.SelectSingle=x});
//# sourceMappingURL=SelectSingle-35ace17a.js.map
