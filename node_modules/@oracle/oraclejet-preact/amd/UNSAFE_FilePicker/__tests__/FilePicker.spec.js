define(["require","preact/jsx-runtime","@testing-library/preact","chai","../../FilePicker-d0dee8c9","../../utils/UNSAFE_matchTranslationBundle","../../UNSAFE_Environment","preact","preact/compat","../../utils/PRIVATE_clientHints","../../utils/PRIVATE_dvtTestUtils","../../clientHints-0d38de57","../../tslib.es6-d8595453","../../utils/UNSAFE_mergeProps","../../utils/UNSAFE_classNames","../../classNames-b7cf3c05","../../hooks/UNSAFE_useTranslationBundle","preact/hooks","../../UNSAFE_Layer","css!./../../UNSAFE_FilePicker.css","../../UNSAFE_Text","../../Text-a22eae5d","../../utils/UNSAFE_mergeInterpolations","../../_curry1-67906f4c","../../_curry3-9a7f6d78","../../_curry2-fc31d1f8","../../_has-83207242","../../UNSAFE_Spacer","../../Spacer-45465d62","../../utils/UNSAFE_interpolations/dimensions","../../utils/UNSAFE_arrayUtils","../../utils/UNSAFE_size","../../utils/UNSAFE_interpolations/flexitem","../../flexitem-c53d7893","../../keys-f8c00540","../../utils/UNSAFE_stringUtils","../../stringUtils-9fd51f79","../../utils/UNSAFE_filePickerUtils","../../hooks/UNSAFE_usePress","../../hooks/UNSAFE_useHover","../../hooks/UNSAFE_useToggle","../../hooks/UNSAFE_useTabbableMode"],function(e,n,s,t,r,l,i,o,a,c,u,d,p,f,b,m,v,g,w,y,x,h,P,E,C,D,F,k,S,T,O,A,M,U,_,j,q,I,N,L,B,H){"use strict";describe("Test Filepicker component",()=>{it("render",async()=>{const e=(await R({accept:["image/*"]})).container.firstElementChild.classList;t.expect(e.length).equals(2)}),it("Focus Blur",async()=>{const e=(await R()).container.firstElementChild;e.focus();let n=document.activeElement;t.expect(e.contains(n),"FilePicker is in focus").equals(!0),e.blur(),n=document.activeElement,t.expect(e.contains(n),"FilePicker no longer in focus").not.equals(!0)}),it("default value for isDisabled",async()=>{var e;const n=null===(e=(await R()).container.firstElementChild.classList)||void 0===e?void 0:e.value;t.expect(n).to.be.a("string").that.not.contains("oj-c-filepicker-disabled")}),it("default value for primaryText",async()=>{const e=await R(),n=await e.findByText("Drag and Drop");t.expect(n).not.null}),it("default value for secondaryText",async()=>{const e=await R(),n=await e.findByText("Select or drop files here");t.expect(n).not.null}),it("default value for accessibleLabel",async()=>{const e=(await R()).container.firstElementChild;t.expect(e.getAttribute("aria-label")).equals("Add Files. Drag and Drop. Select or drop files here")}),it("HandleDragEnter",async()=>{const e=o.createRef();await R({},e);const n=V();e.current.onDragEnter(n.event),await s.waitFor(()=>{n.expectEventToBeCancelled()})});const e=[{description:"Invalid single handleDragOver handleDragLeave",dragOver:["application/pdf"],dragLeave:!0,invalidMessage:"You can't upload files of type application/pdf"},{description:"Invalid single handleDragOver handleFileDrop",dragOver:["application/pdf"],fileDrop:[["test.pdf","application/pdf"]],invalidMessage:"You can't upload files of type application/pdf"},{description:"Invalid single unknown mimetype handleDragOver handleFileDrop",dragOver:[""],fileDrop:[["test.pkg",""]],invalidMessage:"You can't upload files of type unknown",invalidSafariIEMessage:"You can't upload files of type .pkg"},{description:"Invalid single .pem mimetype handleDragOver handleFileDrop",dragOver:[""],fileDrop:[["test.pkg",""]],invalidMessage:"You can't upload files of type .pkg",invalidSafariIEMessage:"You can't upload files of type .pkg",mimeType:[".pem"]},{description:"Invalid single unknown no extension mimetype handleDragOver handleFileDrop",dragOver:[""],fileDrop:[["README",""]],invalidMessage:"You can't upload files of type unknown"},{description:"Invalid multiple unknown mimetype handleDragOver handleFileDrop",dragOver:["",""],fileDrop:[["test.pkg",""],["README",""]],invalidMessage:"You can't upload files of type unknown",invalidSafariIEMessage:"You can't upload files of type: .pkg, unknown"},{description:"Invalid multiple handleDragOver selectionMode single",dragOver:["image/png","image/png"],invalidMessage:"Upload one file at a time",single:!0},{description:"Invalid multiple handleDragOver handleFileDrop",dragOver:["application/pdf","application/pdf"],fileDrop:[["test.pdf","application/pdf"],["test2.pdf","application/pdf"]],invalidMessage:"You can't upload files of type application/pdf"},{description:"Invalid multiple unique types handleDragOver handleFileDrop",dragOver:["application/pdf","video/mp4"],fileDrop:[["test.pdf","application/pdf"],["test.mp4","video/mp4"]],invalidMessage:"You can't upload files of type: application/pdf, video/mp4"}];it("Invalid Scenarios",()=>{e.forEach(async e=>{let n=Promise.resolve();const r=!!e.mimeType,l={invalidCalled:!1},i=o.createRef(),a=await R({accept:e.mimeType?e.mimeType:["image/*"],selectionMode:e.single?"single":"multiple",onReject:s=>{const r=s.messages[0],i="safari"===d.getClientHints().browser&&e.invalidSafariIEMessage?e.invalidSafariIEMessage:e.invalidMessage;t.expect(r.severity,"Message severity is error").to.equal("error"),t.expect(r.summary,"Message summary is correct").to.equal(i),n=s.until,l.invalidCalled=!0}},i),c=a.container.firstElementChild,u=J(e.dragOver,l,c,r),p=i.current;if(p.onDragOver(u.event),await s.waitFor(()=>{u.expectEventToBeCancelled(),u.expectedCalls()}),e.fileDrop){const s=K(e.fileDrop,l,r);p.onDrop(s.event),await n,s.expectEventToBeCancelled(),s.expectedCalls()}if(e.dragLeave){const e=Q(a.container,c);p.onDragLeave(e.event,r),await n,e.expectEventToBeCancelled(),e.expectedCalls()}})});const n=[{description:"Valid single handleDragOver handleFileDrop",dragOver:["image/png"],fileDrop:[["test.png","image/png"]]},{description:"Valid .pem handleDragOver handleFileDrop",dragOver:[""],fileDrop:[["test.pem",""]],mimeType:[".pem"]},{description:"Valid multiple handleDragOver handleFileDrop",dragOver:["image/png","image/png"],fileDrop:[["test.png","image/png"],["test2.png","image/png"]]}];it("Valid Scenarios",()=>{n.forEach(async e=>{const n=o.createRef(),r=await R({accept:e.mimeType?e.mimeType:["image/*"],onReject:()=>{t.expect(!1,"Invalid Select Listener should not be called").to.be.true},onCommit:n=>{const s=n.files;let r;for(let n=0;n<s.length;n++)r=s[n],t.expect(r.name,"File name is correct").to.equal(e.fileDrop[n][0]),t.expect(r.type,"File type is correct").to.equal(e.fileDrop[n][1]);l.selectCalled=!0}},n),l={selectCalled:!1},i=r.container.firstElementChild,a=n.current,c=G(e.dragOver,i);a.onDragOver(c.event),await s.waitFor(()=>{c.expectEventToBeCancelled(),c.expectedCalls()});const u=$(e.fileDrop,l);a.onDrop(u.event),await s.waitFor(()=>{u.expectEventToBeCancelled(),u.expectedCalls()})})}),it("handleFileSelected (click listener)",async()=>{let e;const n={select:!1},s="image/png",r="test.png",l=new Promise(n=>{e=n}),i=o.createRef();await R({accept:["image/*"],onCommit:l=>{const i=l.files[0];t.expect(i.name,"File name is correct").to.equal(r),t.expect(i.type,"File type is correct").to.equal(s),n.select=!0,e()}},i);const a=i.current,c=W(n);a.onClickSelected([{name:r,type:s}]),await l,c()}),"edge"===d.getClientHints().browser&&it("handleFileSelected invalid file Edge(click listener)",async()=>{const e={invalid:!1},n=o.createRef(),r=await R({onReject:n=>{const s=n.detail.messages[0];t.expect(s.severity,"Message severity is error").to.equal("error"),t.expect(s.summary,"Message summary is correct").to.equal("You can't upload files of type "+i+"."),e.invalid=!0,a()}},n);s.render(r);const l=n.current,i="document/pdf";let a;const c=new Promise((e,n)=>{a=e,n=n}),u=W(e);l.onClickSelected([{name:"test.pdf",type:i}]),await c,u()})}),describe("File Picker - TabbableModeContext",()=>{it(" RootEnvironmentProvider is not present",async()=>{const e=(await R()).container.firstElementChild,n=null==e?void 0:e.getAttribute("tabindex");t.expect(n).to.equal("0")}),it("TabbableModeContext isTabbable=true",async()=>{const e=n.jsx(r.FilePicker,{}),s=(await u.default(e,!0)).container.firstElementChild,l=null==s?void 0:s.getAttribute("tabindex");t.expect(l).to.equal("0")}),it("TabbableModeContext isTabbable=false",async()=>{const e=n.jsx(r.FilePicker,{}),s=(await u.default(e,!1)).container.firstElementChild,l=null==s?void 0:s.getAttribute("tabindex");t.expect(l).to.equal("-1")}),it("TabbableModeContext not provided",async()=>{const e=n.jsx(r.FilePicker,{}),s=(await u.default(e)).container.firstElementChild,l=null==s?void 0:s.getAttribute("tabindex");t.expect(l).to.equal("0")})});const R=async(t={},o)=>{const c=l.matchTranslationBundle(["en"],new Set(["en-US","en"])),{default:u}=await function(n){switch(n){case"../../resources/nls/ar/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ar/bundle"],n,s)});case"../../resources/nls/ar-XB/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ar-XB/bundle"],n,s)});case"../../resources/nls/bg/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/bg/bundle"],n,s)});case"../../resources/nls/bs/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/bs/bundle"],n,s)});case"../../resources/nls/bs-Cyrl/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/bs-Cyrl/bundle"],n,s)});case"../../resources/nls/cs/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/cs/bundle"],n,s)});case"../../resources/nls/da/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/da/bundle"],n,s)});case"../../resources/nls/de/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/de/bundle"],n,s)});case"../../resources/nls/el/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/el/bundle"],n,s)});case"../../resources/nls/en/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/en/bundle"],n,s)});case"../../resources/nls/en-XA/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/en-XA/bundle"],n,s)});case"../../resources/nls/en-XC/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/en-XC/bundle"],n,s)});case"../../resources/nls/es/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/es/bundle"],n,s)});case"../../resources/nls/et/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/et/bundle"],n,s)});case"../../resources/nls/fi/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/fi/bundle"],n,s)});case"../../resources/nls/fr/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/fr/bundle"],n,s)});case"../../resources/nls/fr-CA/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/fr-CA/bundle"],n,s)});case"../../resources/nls/he/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/he/bundle"],n,s)});case"../../resources/nls/hr/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/hr/bundle"],n,s)});case"../../resources/nls/hu/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/hu/bundle"],n,s)});case"../../resources/nls/is/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/is/bundle"],n,s)});case"../../resources/nls/it/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/it/bundle"],n,s)});case"../../resources/nls/ja/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ja/bundle"],n,s)});case"../../resources/nls/ko/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ko/bundle"],n,s)});case"../../resources/nls/lt/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/lt/bundle"],n,s)});case"../../resources/nls/lv/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/lv/bundle"],n,s)});case"../../resources/nls/ms/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ms/bundle"],n,s)});case"../../resources/nls/nl/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/nl/bundle"],n,s)});case"../../resources/nls/no/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/no/bundle"],n,s)});case"../../resources/nls/pl/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/pl/bundle"],n,s)});case"../../resources/nls/pt/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/pt/bundle"],n,s)});case"../../resources/nls/pt-PT/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/pt-PT/bundle"],n,s)});case"../../resources/nls/ro/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ro/bundle"],n,s)});case"../../resources/nls/ru/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/ru/bundle"],n,s)});case"../../resources/nls/sk/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/sk/bundle"],n,s)});case"../../resources/nls/sl/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/sl/bundle"],n,s)});case"../../resources/nls/sr/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/sr/bundle"],n,s)});case"../../resources/nls/sr-Latn/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/sr-Latn/bundle"],n,s)});case"../../resources/nls/sv/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/sv/bundle"],n,s)});case"../../resources/nls/th/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/th/bundle"],n,s)});case"../../resources/nls/tr/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/tr/bundle"],n,s)});case"../../resources/nls/uk/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/uk/bundle"],n,s)});case"../../resources/nls/vi/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/vi/bundle"],n,s)});case"../../resources/nls/zh-Hans/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/zh-Hans/bundle"],n,s)});case"../../resources/nls/zh-Hant/bundle.ts":return new Promise(function(n,s){e(["../../resources/nls/zh-Hant/bundle"],n,s)});default:return new Promise(function(e,s){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+n)))})}}(`../../resources/nls/${c}/bundle.ts`),d={translations:{"@oracle/oraclejet-preact":u}};let p;if(o){const e=a.forwardRef(Y);p=n.jsx(e,Object.assign({ref:o},t))}else p=n.jsx(r.FilePicker,Object.assign({},t));return s.render(n.jsx(i.RootEnvironmentProvider,Object.assign({environment:d},{children:p})))},Y=(e,s)=>{const t=r.FilePicker,l=Object.assign({__testHandlerSymbol:s},e);return n.jsx(t,Object.assign({},l))},V=()=>{let e=!1,n=!1;return{event:{preventDefault:()=>{e=!0},stopPropagation:()=>{n=!0}},expectEventToBeCancelled:()=>{t.expect(e,"Default prevented").to.be.true,t.expect(n,"Propagation stopped").to.be.true}}},X=e=>{const n=V(),s=[];for(const n of e)s.push({kind:"file",type:n});const t="safari"===d.getClientHints().browser?null:{items:s};return n.event.dataTransfer=t,n},z=e=>{const n=V(),s=[];let t;for(let n=0;n<e.length;n++)t=e[n],s.push({name:t[0],type:t[1]});return n.event.dataTransfer={files:s},n},$=(e,n)=>{const s=z(e);return s.expectedCalls=()=>{t.expect(n.selectCalled,"Select Listener Event fired").to.be.true},s},G=(e,n)=>{const s=X(e);return s.expectedCalls=()=>{t.expect(null!==n.querySelector(".oj-c-valid-drop"),"Overlay shown").to.be.true},s},J=(e,n,s,r)=>{const l=X(e);return l.expectedCalls=()=>{"safari"===d.getClientHints().browser||r?(t.expect(null!==s.querySelector(".oj-c-valid-drop"),"Overlay shown").to.be.true,t.expect(n.invalidCalled,"Invalid Listener Event not fired in IE or Safari").to.be.false):t.expect(n.invalidCalled,"Invalid Listener Event fired").to.be.true},l},K=(e,n,s)=>{const r=z(e);return r.expectedCalls=()=>{("safari"===d.getClientHints().browser||s)&&t.expect(n.invalidCalled,"Invalid Listener Event fired").to.be.true},r},Q=(e,n)=>{const s=V();s.event.relatedTarget=e;const r="safari"===d.getClientHints().browser;return s.expectedCalls=()=>{r?t.expect(null===n.querySelector(".oj-c-invalid-drop"),"Invalid State removed").to.be.true:t.expect(null===n.querySelector(".oj-c-valid-drop"),"Overlay removed").to.be.true},s},W=e=>()=>{for(const n of Object.keys(e))t.expect(e[n],n+" Listener Event fired").to.be.true}});
//# sourceMappingURL=FilePicker.spec.js.map
