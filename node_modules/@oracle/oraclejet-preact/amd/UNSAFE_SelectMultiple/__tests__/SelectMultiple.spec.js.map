{"version":3,"file":"SelectMultiple.spec.js","sources":["../../../../src/UNSAFE_SelectMultiple/__tests__/SelectMultiple.spec.tsx"],"sourcesContent":["import { ComponentProps } from 'preact';\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\nimport { cleanup, fireEvent, render, waitFor } from '@testing-library/preact';\nimport { expect } from 'chai';\nimport { DataState, Range } from '../../UNSAFE_Collection';\nimport { KEYS } from '../../PRIVATE_SelectCommon';\nimport { SelectMultiple } from '../SelectMultiple';\nimport { ValueUpdateDetail } from '../../utils/UNSAFE_valueUpdateDetail';\nimport { Item } from '../../utils/UNSAFE_dataProvider';\nimport type { RootEnvironment } from '../../UNSAFE_Environment';\nimport { RootEnvironmentProvider } from '../../UNSAFE_Environment';\nimport { matchTranslationBundle } from '../../utils/UNSAFE_matchTranslationBundle';\n\nafterEach(cleanup);\n\nconst valueItems = [\n  { key: 'CH', data: { value: 'CH', label: 'Chrome' }, metadata: { key: 'CH' } },\n  { key: 'FF', data: { value: 'FF', label: 'Firefox' }, metadata: { key: 'FF' } }\n];\nconst valueItems2 = [{ key: 'OP', data: { value: 'OP', label: 'Opera' }, metadata: { key: 'OP' } }];\n\nconst noOp = () => {};\n\ntype Key = string;\ntype Data = {\n  value: string;\n  label: string;\n};\nconst items: Data[] = [\n  { value: 'IE', label: 'Internet Explorer' },\n  { value: 'FF', label: 'Firefox' },\n  { value: 'CH', label: 'Chrome' },\n  { value: 'OP', label: 'Opera' },\n  { value: 'SA', label: 'Safari' }\n];\nconst keyAttr = 'value';\n\ntype PickedPropsFromSelectMultiple = Pick<\n  ComponentProps<typeof SelectMultiple>,\n  | 'assistiveText'\n  | 'helpSourceLink'\n  | 'helpSourceText'\n  | 'isDisabled'\n  | 'isReadonly'\n  | 'isRequired'\n  | 'label'\n  | 'labelEdge'\n  | 'messages'\n  | 'placeholder'\n  | 'textAlign'\n  | 'userAssistanceDensity'\n  | 'valueItems'\n>;\ntype DemoSelectMultipleProps = PickedPropsFromSelectMultiple & {\n  data?: Data[];\n};\nfunction DemoSelectMultiple({\n  assistiveText,\n  data = items,\n  helpSourceLink,\n  helpSourceText,\n  isDisabled,\n  isReadonly,\n  isRequired,\n  label,\n  labelEdge,\n  messages,\n  placeholder,\n  textAlign,\n  userAssistanceDensity,\n  valueItems\n}: DemoSelectMultipleProps) {\n  const [myValues, setMyValues] = useState<Set<Key> | undefined>();\n  const [myValueItems, setMyValueItems] = useState(valueItems);\n  const handleCommit = useCallback(\n    (detail: ValueUpdateDetail<Set<Key>>) => {\n      if (myValues != detail.value) {\n        setMyValues(detail.value);\n\n        const newValueItems: Item<Key, Data>[] = [];\n        detail.value?.forEach((key) => {\n          const item = data?.find((element) => element[keyAttr] === key);\n          if (item) {\n            newValueItems.push({\n              key: item[keyAttr],\n              data: item,\n              metadata: { key: item[keyAttr] }\n            });\n          }\n        });\n        setMyValueItems(newValueItems.length > 0 ? newValueItems : undefined);\n      }\n    },\n    [myValues]\n  );\n\n  const dataMapFunc = (value: any) => {\n    return { data: value, metadata: { key: value[keyAttr] } };\n  };\n\n  const dataMetadataRef = useRef(data?.map(dataMapFunc));\n\n  const [dataState, setDataState] = useState<DataState<string, Data> | null>({\n    offset: 0,\n    totalSize: dataMetadataRef.current?.length ?? 0,\n    sizePrecision: 'exact',\n    data: dataMetadataRef.current.slice(0, dataMetadataRef.current.length)\n  });\n\n  const [filter, setFilter] = useState('');\n\n  const handleFilter = useCallback(({ searchText }: { searchText?: string }) => {\n    setFilter(searchText ?? '');\n  }, []);\n\n  const delay = 0;\n\n  // this effect should only be run when filter has changed\n  const firstRender = useRef(true);\n  useEffect(() => {\n    if (firstRender.current) {\n      firstRender.current = false;\n      return;\n    }\n\n    // put ListView into loading state\n    setDataState(null);\n\n    setTimeout(() => {\n      // figure out what data to show\n      const dataToShow =\n        filter != null && filter.trim().length > 0\n          ? data?.filter((value: Data) => {\n              return value.label.toLowerCase().indexOf(filter.toLowerCase()) > -1;\n            })\n          : data;\n      dataMetadataRef.current = dataToShow?.map(dataMapFunc);\n\n      // update DataState to show the first 25 results\n      loadRange({ offset: 0, count: 25 });\n    }, delay);\n  }, [filter]);\n\n  const loadRange = (range: Range) => {\n    const startIndex = range.offset;\n    const endIndex = startIndex + range.count;\n    const newDataState: DataState<string, Data> = {\n      offset: startIndex,\n      totalSize: dataMetadataRef.current?.length ?? 0,\n      sizePrecision: 'exact',\n      data: dataMetadataRef.current.slice(startIndex, endIndex)\n    };\n    setDataState(newDataState);\n  };\n\n  return (\n    // <SelectMultiple<Key, Data>\n    <SelectMultiple\n      assistiveText={assistiveText}\n      data={dataState}\n      helpSourceLink={helpSourceLink}\n      helpSourceText={helpSourceText}\n      isDisabled={isDisabled}\n      isReadonly={isReadonly}\n      isRequired={isRequired}\n      itemText=\"label\"\n      label={label}\n      labelEdge={labelEdge}\n      messages={messages}\n      onCommit={handleCommit as any}\n      onFilter={handleFilter}\n      onLoadRange={loadRange}\n      placeholder={placeholder}\n      textAlign={textAlign}\n      userAssistanceDensity={userAssistanceDensity}\n      valueItems={myValueItems as any}></SelectMultiple>\n  );\n}\n\nasync function getEnvironmentContext() {\n  const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n  const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n  return {\n    translations: { '@oracle/oraclejet-preact': translations }\n  } as Partial<RootEnvironment>;\n}\n\n// function TestSelectMultipleComp(props: any) {\n//   const [commitDetail, setCommitDetail] = useState<any>();\n//   const handleCommit = (detail: any) => {\n//     setCommitDetail(detail);\n//   };\n//   const commitDetailValue = commitDetail?.value ? [...commitDetail.value?.values()].join(', ') : '';\n//   return (\n//     <div>\n//       <SelectMultiple {...props} onCommit={handleCommit} />\n//       <div>{commitDetailValue}</div>\n//     </div>\n//   );\n// }\n\ndescribe('Test SelectMultiple component:', () => {\n  // this beforeEach was copied from ListView.spec.tsx, and appears to be needed for ListView\n  beforeEach(() => {\n    if (!window.IntersectionObserver) {\n      // IntersectionObserver isn't available in test environment\n      const MockIntersectionObserver = jest.fn();\n      MockIntersectionObserver.mockReturnValue({\n        observe: () => null,\n        unobserve: () => null,\n        disconnect: () => null\n      });\n\n      Object.defineProperty(global, 'IntersectionObserver', {\n        writable: true,\n        configurable: true,\n        value: MockIntersectionObserver\n      });\n    }\n  });\n\n  it('translation bundle', async () => {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const content = render(\n      <RootEnvironmentProvider environment={env}>\n        <SelectMultiple\n          itemText=\"label\"\n          label=\"Enabled\"\n          labelEdge=\"inside\"\n          valueItems={valueItems}\n          onCommit={noOp}\n        />\n      </RootEnvironmentProvider>\n    );\n\n    const chip = await content.findByText('2');\n    expect(chip, 'initial selected values count shown').not.null;\n    expect(chip.getAttribute('aria-label')).equals(\n      'Enabled. 2 values selected. Show selected values only.'\n    );\n  });\n\n  it('initialize with valueItems', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const content = render(\n      <RootEnvironmentProvider environment={env}>\n        <SelectMultiple\n          itemText=\"label\"\n          label=\"Enabled\"\n          labelEdge=\"inside\"\n          valueItems={valueItems}\n          onCommit={noOp}\n        />\n      </RootEnvironmentProvider>\n    );\n\n    const input = await content.findByDisplayValue('Chrome, Firefox');\n    expect(input, 'initial selected valueItems text shown').not.null;\n  });\n\n  it('programmatically change valueItems', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <SelectMultiple\n          itemText=\"label\"\n          label=\"Enabled\"\n          labelEdge=\"inside\"\n          valueItems={valItems}\n          onCommit={noOp}\n        />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    let input = await content.findByDisplayValue('Chrome, Firefox');\n    expect(input, 'initial selected valueItems text shown').not.null;\n\n    content.rerender(getComp(valueItems2));\n\n    input = await content.findByDisplayValue('Opera');\n    expect(input, 'changed selected valueItems text shown').not.null;\n  });\n\n  it('shows moves UserAssistance correctly on focus', async () => {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const { container, queryByText } = render(\n      <div>\n        <RootEnvironmentProvider environment={env}>\n          <SelectMultiple\n            itemText=\"label\"\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            assistiveText=\"help instruction\"\n            onCommit={noOp}\n          />\n        </RootEnvironmentProvider>\n        <button />\n      </div>\n    );\n    const inputElement = container.querySelector('input');\n    const buttonElement = container.querySelector('button');\n\n    // check for no help.instruction initially\n    expect(queryByText('help instruction'), 'help instruction is not shown initially').be.null;\n\n    // focus input\n    inputElement?.focus();\n    waitFor(\n      () =>\n        expect(queryByText('help instruction'), 'help instruction is shown on focus').be.not.null\n    );\n\n    // focus outside\n    buttonElement?.focus();\n    waitFor(\n      () => expect(queryByText('help instruction'), 'help instruction is not shown on blur').be.null\n    );\n  });\n\n  it('open dropdown on dropdown arrow click', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n    const container = content.container;\n\n    const dropdownArrow = container.querySelector('span[aria-hidden=\"true\"][tabindex=\"-1\"]');\n    expect(dropdownArrow, 'dropdown arrow element found').not.null;\n\n    if (dropdownArrow) {\n      fireEvent.click(dropdownArrow);\n    }\n\n    const dropdown = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n  });\n\n  it('close dropdown on dropdown arrow click', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n    const container = content.container;\n\n    const dropdownArrow = container.querySelector('span[aria-hidden=\"true\"][tabindex=\"-1\"]');\n    expect(dropdownArrow, 'dropdown arrow element found').not.null;\n\n    if (dropdownArrow) {\n      fireEvent.click(dropdownArrow);\n    }\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n\n    if (dropdownArrow) {\n      fireEvent.click(dropdownArrow);\n    }\n\n    // await waitForElementToBeRemoved(() => content.queryByText('Firefox'));\n    dropdown = content.queryByText('Firefox');\n    expect(dropdown, 'dropdown closed').null;\n  });\n\n  it('open dropdown on input mousedown', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.click(input);\n    fireEvent.mouseDown(input);\n\n    const dropdown = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n  });\n\n  it('open dropdown on down arrow keyup', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.type(input, '{ArrowDown}', { skipClick: true });\n    fireEvent.keyUp(input, { code: KEYS.DOWN });\n\n    const dropdown = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n  });\n\n  it('open dropdown on up arrow keyup', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.keyboard('[ArrowUp]');\n    fireEvent.keyUp(input, { code: KEYS.UP });\n\n    const dropdown = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n  });\n\n  it('close dropdown on Esc keydown', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.click(input);\n    fireEvent.mouseDown(input);\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.ESC });\n\n    // await waitForElementToBeRemoved(() => content.queryByText('Firefox'));\n    dropdown = content.queryByText('Firefox');\n    expect(dropdown, 'dropdown closed').null;\n  });\n\n  it('close dropdown on Tab keydown in input', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.click(input);\n    fireEvent.mouseDown(input);\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.TAB, shiftKey: true });\n\n    // await waitForElementToBeRemoved(() => content.queryByText('Firefox'));\n    dropdown = content.queryByText('Firefox');\n    expect(dropdown, 'dropdown closed').null;\n  });\n\n  it('close dropdown on Esc keydown in dropdown', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" valueItems={valItems} />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.click(input);\n    fireEvent.mouseDown(input);\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n\n    fireEvent.keyDown(dropdown, { code: KEYS.ESC });\n\n    // await waitForElementToBeRemoved(() => content.queryByText('Firefox'));\n    dropdown = content.queryByText('Firefox');\n    expect(dropdown, 'dropdown closed').null;\n  });\n\n  it('selected values count shown', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <SelectMultiple\n          itemText=\"label\"\n          label=\"Enabled\"\n          labelEdge=\"inside\"\n          valueItems={valItems}\n          onCommit={noOp}\n        />\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    let chip = await content.findByText('2');\n    expect(chip, 'initial selected values count shown').not.null;\n\n    content.rerender(getComp(valueItems2));\n\n    chip = await content.findByText('1');\n    expect(chip, 'changed selected values count shown').not.null;\n  });\n\n  it('click on selected values count chip to toggle dropdown selected-only mode', async function () {\n    const locale = matchTranslationBundle(['en'], new Set(['en-US', 'en']));\n    const { default: translations } = await import(`../../resources/nls/${locale}/bundle.ts`);\n    const env: Partial<RootEnvironment> = {\n      translations: { '@oracle/oraclejet-preact': translations }\n    };\n    const content = render(\n      <RootEnvironmentProvider environment={env}>\n        <DemoSelectMultiple\n          data={items}\n          label=\"Enabled\"\n          labelEdge=\"inside\"\n          valueItems={valueItems}\n        />\n      </RootEnvironmentProvider>\n    );\n\n    const chip = await content.findByText('2');\n    expect(chip, 'initial selected values count shown').not.null;\n\n    // open dropdown in selected-only mode\n    if (chip) {\n      fireEvent.click(chip);\n    }\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'selected dropdown list item found in selected-only list').not.null;\n\n    dropdown = content.queryByText('Opera');\n    expect(dropdown, 'unselected dropdown list item not found in selected-only list').null;\n\n    // switch dropdown to full list\n    if (chip) {\n      fireEvent.click(chip);\n    }\n\n    dropdown = await content.findByText('Opera');\n    expect(dropdown, 'unselected dropdown list item found in full list').not.null;\n  });\n\n  // The below tests are for:\n  // JET-53183 - core pack compat: stop propagation of handled events\n  // SelectMultiple stops keydown events from propagating when it has handled them so that a parent\n  // collection component won't also handle them.\n\n  it('JET-53183 - propagation not stopped for Enter keydown in input', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.ENTER });\n\n    expect(keyDownReceived, 'propagation not stopped').to.be.true;\n  });\n\n  it('JET-53183 - propagation not stopped for Esc keydown in input when dropdown closed', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.ESC });\n\n    expect(keyDownReceived, 'propagation not stopped').to.be.true;\n  });\n\n  it('JET-53183 - propagation stopped for Esc keydown in input when dropdown open', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    // userEvent.click(input);\n    fireEvent.mouseDown(input);\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.ESC });\n\n    // await waitForElementToBeRemoved(() => content.queryByText('Firefox'));\n    dropdown = content.queryByText('Firefox');\n    expect(dropdown, 'dropdown closed').null;\n\n    expect(keyDownReceived, 'propagation stopped').to.be.false;\n  });\n\n  it('JET-53183 - propagation not stopped for Shift+Tab keydown in input', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.TAB, shiftKey: true });\n\n    expect(keyDownReceived, 'propagation not stopped').to.be.true;\n  });\n\n  it('JET-53183 - propagation not stopped for Tab keydown in input when no selected values count chip', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = () => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple data={items} label=\"Enabled\" labelEdge=\"inside\" />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp());\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.TAB });\n\n    expect(keyDownReceived, 'propagation not stopped').to.be.true;\n  });\n\n  it('JET-53183 - propagation stopped for Tab keydown in input when selected values count chip displayed', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    fireEvent.keyDown(input, { code: KEYS.TAB });\n\n    expect(keyDownReceived, 'propagation stopped').to.be.false;\n  });\n\n  it('JET-53183 - propagation stopped for Enter keydown in selected values count chip', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const chip = await content.findByText('2');\n    expect(chip, 'selected values count chip found').not.null;\n\n    fireEvent.keyDown(chip, { code: KEYS.ENTER });\n\n    expect(keyDownReceived, 'propagation stopped').to.be.false;\n  });\n\n  it('JET-53183 - propagation not stopped for Esc keydown in selected values count chip when dropdown closed', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const chip = await content.findByText('2');\n    expect(chip, 'selected values count chip found').not.null;\n\n    fireEvent.keyDown(chip, { code: KEYS.ESC });\n\n    expect(keyDownReceived, 'propagation not stopped').to.be.true;\n  });\n\n  it('JET-53183 - propagation stopped for Esc keydown in selected values count chip when dropdown open', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const input = await content.findByRole('combobox');\n    expect(input, 'input element found').not.null;\n\n    const chip = await content.findByText('2');\n    expect(chip, 'selected values count chip found').not.null;\n\n    // userEvent.click(input);\n    fireEvent.mouseDown(input);\n\n    let dropdown: HTMLElement | null = await content.findByText('Firefox');\n    expect(dropdown, 'dropdown open').not.null;\n\n    fireEvent.keyDown(chip, { code: KEYS.ESC });\n\n    // await waitForElementToBeRemoved(() => content.queryByText('Firefox'));\n    dropdown = content.queryByText('Firefox');\n    expect(dropdown, 'dropdown closed').null;\n\n    expect(keyDownReceived, 'propagation stopped').to.be.false;\n  });\n\n  it('JET-53183 - propagation stopped for Shift+Tab keydown in selected values count chip', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const chip = await content.findByText('2');\n    expect(chip, 'selected values count chip found').not.null;\n\n    fireEvent.keyDown(chip, { code: KEYS.TAB, shiftKey: true });\n\n    expect(keyDownReceived, 'propagation stopped').to.be.false;\n  });\n\n  it('JET-53183 - propagation not stopped for Tab keydown in selected values count chip', async function () {\n    const env = await getEnvironmentContext();\n    let keyDownReceived = false;\n    const handleKeyDown = () => {\n      keyDownReceived = true;\n    };\n    const getComp = (valItems: any) => (\n      <RootEnvironmentProvider environment={env}>\n        <div onKeyDown={handleKeyDown}>\n          <DemoSelectMultiple\n            data={items}\n            label=\"Enabled\"\n            labelEdge=\"inside\"\n            valueItems={valItems}\n          />\n        </div>\n      </RootEnvironmentProvider>\n    );\n    const content = render(getComp(valueItems));\n\n    const chip = await content.findByText('2');\n    expect(chip, 'selected values count chip found').not.null;\n\n    fireEvent.keyDown(chip, { code: KEYS.TAB });\n\n    expect(keyDownReceived, 'propagation not stopped').to.be.true;\n  });\n\n  afterEach(cleanup);\n});\n"],"names":["afterEach","cleanup","valueItems","key","data","value","label","metadata","valueItems2","noOp","items","DemoSelectMultiple","assistiveText","helpSourceLink","helpSourceText","isDisabled","isReadonly","isRequired","labelEdge","messages","placeholder","textAlign","userAssistanceDensity","myValues","setMyValues","useState","myValueItems","setMyValueItems","handleCommit","useCallback","detail","newValueItems","_a","forEach","item","find","element","push","length","undefined","dataMapFunc","dataMetadataRef","useRef","map","dataState","setDataState","offset","totalSize","current","_b","sizePrecision","slice","filter","setFilter","handleFilter","searchText","firstRender","useEffect","setTimeout","dataToShow","trim","toLowerCase","indexOf","loadRange","count","range","startIndex","endIndex","newDataState","_jsx","SelectMultiple","itemText","onCommit","onFilter","onLoadRange","async","getEnvironmentContext","locale","matchTranslationBundle","Set","default","translations","__variableDynamicImportRuntime0__","describe","beforeEach","window","IntersectionObserver","MockIntersectionObserver","jest","fn","mockReturnValue","observe","unobserve","disconnect","Object","defineProperty","global","writable","configurable","it","__variableDynamicImportRuntime1__","env","content","render","RootEnvironmentProvider","assign","environment","jsx","chip","findByText","expect","not","null","getAttribute","equals","__variableDynamicImportRuntime2__","input","findByDisplayValue","__variableDynamicImportRuntime3__","getComp","valItems","rerender","__variableDynamicImportRuntime4__","container","queryByText","_jsxs","children","inputElement","querySelector","buttonElement","be","focus","waitFor","__variableDynamicImportRuntime5__","dropdownArrow","fireEvent","click","dropdown","__variableDynamicImportRuntime6__","__variableDynamicImportRuntime7__","findByRole","mouseDown","__variableDynamicImportRuntime8__","keyUp","code","KEYS","DOWN","__variableDynamicImportRuntime9__","UP","__variableDynamicImportRuntime10__","keyDown","ESC","__variableDynamicImportRuntime11__","TAB","shiftKey","__variableDynamicImportRuntime12__","__variableDynamicImportRuntime13__","__variableDynamicImportRuntime14__","keyDownReceived","handleKeyDown","onKeyDown","ENTER","to","true","false"],"mappings":"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"}