{"version":3,"file":"useModal-221efa6e.js","sources":["../../src/UNSAFE_Modal/hooks/useModal.ts"],"sourcesContent":["\nimport { useRef, useCallback, useEffect } from \"preact/compat\";\n\nexport type UseModalProps = Readonly<{\n    /**\n     * Determines whether the Modal is open.\n     */\n    isOpen : boolean;\n    /**\n     * On backdrop click callback.\n     */\n    onBackdropClick? : () => void;\n  }>;\n  \n  /**\n   *\n   * @param props\n   */\n  export const useModal = (props: UseModalProps) => {\n    \n    const {\n      isOpen,\n      onBackdropClick : onBackdropClickProp,\n    } = props;\n\n    const modalRef = useRef<HTMLDivElement>(null)\n\n    const mouseDownTarget = useRef<EventTarget | null>(null);\n\n    const onMouseDown = useCallback( (event: MouseEvent) => {\n        if (modalRef.current === event.target) {\n          mouseDownTarget.current = event.target\n        }\n      }, []);\n\n    const onBackdropClick = useCallback( (event: MouseEvent) => {\n      \n      if (modalRef.current === event.target) {\n        event.stopPropagation()\n        // event should originate on the same target\n        if (mouseDownTarget.current === event.target) {\n          onBackdropClickProp?.()\n        }\n      }\n    }, [onBackdropClickProp] )\n\n    useEffect(() => {\n      const modal = modalRef.current;\n\n      if (modal) {\n        modal.addEventListener('mousedown', onMouseDown);\n        modal.addEventListener('click', onBackdropClick); \n\n        return () => {\n          modal.removeEventListener('mousedown', onMouseDown);\n          modal.removeEventListener('click', onBackdropClick);\n        }\n      }\n\n      return () => {};\n    }, [isOpen, onMouseDown, onBackdropClick]);\n\n    return {\n      modalRef,\n    }\n\n  };\n  \n  export default useModal;\n  "],"names":["props","isOpen","onBackdropClick","onBackdropClickProp","modalRef","useRef","mouseDownTarget","onMouseDown","useCallback","event","current","target","stopPropagation","useEffect","modal","addEventListener","removeEventListener"],"mappings":"yEAkB2BA,IAEvB,MAAMC,OACJA,EACAC,gBAAkBC,GAChBH,EAEEI,EAAWC,SAAuB,MAElCC,EAAkBD,SAA2B,MAE7CE,EAAcC,cAAcC,IAC1BL,EAASM,UAAYD,EAAME,SAC7BL,EAAgBI,QAAUD,EAAME,SAEjC,IAECT,EAAkBM,cAAcC,IAEhCL,EAASM,UAAYD,EAAME,SAC7BF,EAAMG,kBAEFN,EAAgBI,UAAYD,EAAME,SACpCR,MAAAA,GAAAA,OAGH,CAACA,IAkBJ,OAhBAU,EAAAA,UAAU,KACR,MAAMC,EAAQV,EAASM,QAEvB,OAAII,GACFA,EAAMC,iBAAiB,YAAaR,GACpCO,EAAMC,iBAAiB,QAASb,GAEzB,KACLY,EAAME,oBAAoB,YAAaT,GACvCO,EAAME,oBAAoB,QAASd,KAIhC,QACN,CAACD,EAAQM,EAAaL,IAElB,CACLE,SAAAA"}