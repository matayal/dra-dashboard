{"version":3,"file":"SelectSingleMenuGroup.spec.js","sources":["../../../../src/UNSAFE_Menu/SelectSingleMenuGroup.tsx","../../../../src/UNSAFE_Menu/__tests__/SelectSingleMenuGroup.spec.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ComponentChildren } from 'preact';\n\nimport { MenuValueUpdateDetail } from './menuUtils';\nimport { SelectMenuGroupContext } from './SelectMenuGroupContext';\n\ntype SelectSingleMenuGroupProps = {\n  children: ComponentChildren;\n  value?: string;\n  onCommit?: (detail: MenuValueUpdateDetail<string>) => void;\n};\n\nexport function SelectSingleMenuGroup({ value, onCommit, children }: SelectSingleMenuGroupProps) {\n  return (\n    <SelectMenuGroupContext.Provider value={{ isMultiple: false, value, onCommit }}>\n      {children}\n    </SelectMenuGroupContext.Provider>\n  );\n}\n","import { useState, useRef } from 'preact/hooks';\nimport { render, fireEvent } from '@testing-library/preact';\n\nimport { expect } from 'chai';\nimport { spy } from 'sinon';\n\nimport { Button } from '../../UNSAFE_Button';\n\nimport { Menu } from '../Menu';\nimport { SelectMenuItem } from '../SelectMenuItem';\nimport { SelectSingleMenuGroup } from '../SelectSingleMenuGroup';\nimport { RootEnvironmentProvider } from '../../UNSAFE_Environment';\nimport { MenuValueUpdateDetail } from '../menuUtils';\nimport { getIcon, setObserverConfig, getAllMenuItemsByRole } from './menuTestsUtils';\n\nconst SelectMenu = ({\n  initialValue,\n  onCommit\n}: {\n  initialValue?: string;\n  onCommit?: (detail: MenuValueUpdateDetail<string>) => void;\n}) => {\n  const [selectSingleValue, setSelectSingleValue] = useState(initialValue);\n\n  const handleCommit = ({ value }: MenuValueUpdateDetail<string>) => {\n    setSelectSingleValue(value);\n  };\n\n  const ref = useRef(null);\n\n  return (\n    <>\n      <RootEnvironmentProvider>\n        <Button ref={ref} label=\"Text Wrapping\" />\n        <Menu isOpen={true} anchorRef={ref}>\n          <SelectSingleMenuGroup value={selectSingleValue} onCommit={onCommit || handleCommit}>\n            <SelectMenuItem value=\"overflow\" label=\"Overflow\"></SelectMenuItem>\n            <SelectMenuItem value=\"wrap\" label=\"Wrap\"></SelectMenuItem>\n            <SelectMenuItem value=\"clip\" label=\"Clip\"></SelectMenuItem>\n          </SelectSingleMenuGroup>\n        </Menu>\n      </RootEnvironmentProvider>\n    </>\n  );\n};\n\ndescribe('Test Menu Component', () => {\n  beforeEach(() => {\n    setObserverConfig();\n  });\n\n  it('onCommit called when selecting item', async function () {\n    const dummyFunc = spy();\n    const content = render(<SelectMenu onCommit={dummyFunc} />);\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemradio');\n    fireEvent.click(menuItems[0]);\n\n    expect(dummyFunc.calledOnce).to.be.true;\n  });\n\n  it('Initial SelectSingleMenuGroup render without value', async function () {\n    const content = render(<SelectMenu />);\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemradio');\n\n    const firstItem = menuItems[0];\n    const secondItem = menuItems[1];\n    const thirdItem = menuItems[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(firstItem, 'svg')).null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(secondItem, 'svg')).null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n\n  it('Initial SelectSingleMenuGroup render with value', async function () {\n    const content = render(<SelectMenu initialValue=\"overflow\" />);\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemradio');\n\n    const firstItem = menuItems[0];\n    const secondItem = menuItems[1];\n    const thirdItem = menuItems[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('true');\n    expect(getIcon(firstItem, 'svg')).not.null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(secondItem, 'svg')).null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n\n  it('SelectSingleMenuGroup remains the same if selected item is selected again', async function () {\n    const content = render(<SelectMenu initialValue=\"overflow\" />);\n\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemradio');\n    fireEvent.click(menuItems[0]);\n\n    const menuItemsAfterClick = getAllMenuItemsByRole(content, 'menuitemradio');\n\n    const firstItem = menuItemsAfterClick[0];\n    const secondItem = menuItemsAfterClick[1];\n    const thirdItem = menuItemsAfterClick[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('true');\n    expect(getIcon(firstItem, 'svg')).not.null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(secondItem, 'svg')).null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n\n  it('SelectSingleMenuGroup selected item changes when selecting it', async function () {\n    const content = render(<SelectMenu initialValue=\"overflow\" />);\n\n    const menuItems = getAllMenuItemsByRole(content, 'menuitemradio');\n    fireEvent.click(menuItems[1]);\n\n    const menuItemsAfterClick = getAllMenuItemsByRole(content, 'menuitemradio');\n\n    const firstItem = menuItemsAfterClick[0];\n    const secondItem = menuItemsAfterClick[1];\n    const thirdItem = menuItemsAfterClick[2];\n\n    expect(firstItem).not.null;\n    expect(firstItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(firstItem, 'svg')).null;\n\n    expect(secondItem).not.null;\n    expect(secondItem.getAttribute('aria-checked')).equals('true');\n    expect(getIcon(secondItem, 'svg')).not.null;\n\n    expect(thirdItem).not.null;\n    expect(thirdItem.getAttribute('aria-checked')).equals('false');\n    expect(getIcon(thirdItem, 'svg')).null;\n  });\n});\n"],"names":["_jsx","SelectMenuGroupContext","useState","useRef","_Fragment","_jsxs","RootEnvironmentProvider","Button","Menu","SelectMenuItem","setObserverConfig","spy","render","getAllMenuItemsByRole","fireEvent","expect","getIcon"],"mappings":"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"}