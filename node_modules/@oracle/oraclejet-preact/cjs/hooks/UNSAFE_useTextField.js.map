{"version":3,"file":"UNSAFE_useTextField.js","sources":["../../../src/hooks/UNSAFE_useTextField/useTextField.ts"],"sourcesContent":["import { ComponentProps } from 'preact';\nimport { useMemo } from 'preact/hooks';\nimport { Label } from '../../UNSAFE_Label';\nimport { TextField } from '../../UNSAFE_TextField';\nimport { InlineUserAssistance } from '../../UNSAFE_UserAssistance';\nimport { FormFieldContextProps } from '../UNSAFE_useFormFieldContext';\nimport { useId } from '../UNSAFE_useId';\n\ntype PickedUserAssistanceProps = Pick<ComponentProps<typeof InlineUserAssistance>, 'messages'>;\n\ntype UseTextFieldProps<V> = PickedUserAssistanceProps & {\n  ariaDescribedBy?: string;\n  contentVariant?: 'input' | 'textarea';\n  isDisabled?: boolean;\n  isFocused?: boolean;\n  isLoading?: boolean;\n  isReadonly?: boolean;\n  labelEdge?: ComponentProps<typeof TextField>['labelEdge'] | 'none';\n  styleVariant?: 'default' | 'embedded';\n  value?: V;\n};\n\nconst rankedSeverities = ['error', 'warning', 'confirmation', 'info', 'none'] as const;\n\n/**\n * Merge multiple ids into a space-separated list\n * @param ids The ids to be merged\n * @returns The space separated string of ids\n */\nfunction mergeIDs(...ids: (string | undefined)[]) {\n  return ids.filter(Boolean).join(' ') || undefined;\n}\n\n/**\n * A custom hook to determine the props for a component that renders\n * a text field\n */\nexport function useTextField<V>({\n  ariaDescribedBy,\n  contentVariant,\n  isDisabled,\n  isFocused,\n  isLoading,\n  isReadonly,\n  labelEdge,\n  messages,\n  styleVariant,\n  value\n}: UseTextFieldProps<V>) {\n  const baseId = useId();\n  const labelId = labelEdge !== 'none' ? `${baseId}-label` : undefined;\n  const inputId = !isReadonly ? `${baseId}-input` : undefined;\n  const uaId = !(isDisabled || isReadonly) ? `${baseId}-ua` : undefined;\n\n  // Create the form field context\n  const formFieldContext = useMemo<FormFieldContextProps>(() => {\n    const hasValue = value !== undefined && (typeof value !== 'string' || value !== '');\n    return isReadonly\n      ? {\n          hasValue: hasValue,\n          isFocused: isFocused,\n          isLoading,\n          isReadonly: true\n        }\n      : isDisabled\n      ? {\n          hasValue: hasValue,\n          isDisabled: true,\n          isLoading\n        }\n      : {\n          hasValue: hasValue,\n          isFocused: isFocused,\n          isLoading\n        };\n  }, [isDisabled, isFocused, isLoading, isReadonly, value]);\n\n  // Determine the highest severity from the messages\n  const messageSeverity = useMemo(() => {\n    return messages === undefined\n      ? undefined\n      : messages.reduce<typeof rankedSeverities[number]>((accSeverity, currMessage) => {\n          const currSeverity = currMessage.severity || 'error';\n          return rankedSeverities.indexOf(accSeverity) < rankedSeverities.indexOf(currSeverity)\n            ? accSeverity\n            : currSeverity;\n        }, 'none');\n  }, [messages]);\n\n  // Determine the label variant\n  const labelVariant: ComponentProps<typeof Label>['variant'] =\n    labelEdge === 'inside'\n      ? messageSeverity === 'error'\n        ? 'insideError'\n        : messageSeverity === 'warning'\n        ? 'insideWarning'\n        : labelEdge\n      : labelEdge !== 'none'\n      ? labelEdge\n      : undefined;\n\n  return {\n    baseId,\n    formFieldContext,\n    inputProps: {\n      id: inputId,\n      ariaDescribedBy: mergeIDs(uaId, ariaDescribedBy),\n      ariaInvalid: messageSeverity === 'error' ? 'true' : undefined,\n      variant: styleVariant\n    },\n    labelProps: {\n      forId: inputId,\n      id: labelId,\n      variant: labelVariant\n    },\n    textFieldProps: {\n      contentVariant,\n      statusVariant: /error|warning/.test(messageSeverity ?? '')\n        ? (messageSeverity as 'error' | 'warning')\n        : undefined,\n      styleVariant\n    },\n    userAssistanceProps: {\n      id: uaId\n    }\n  };\n}\n"],"names":["useId","useMemo"],"mappings":"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"}