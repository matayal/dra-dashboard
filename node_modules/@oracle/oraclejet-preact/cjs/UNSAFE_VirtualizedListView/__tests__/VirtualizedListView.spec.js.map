{"version":3,"file":"VirtualizedListView.spec.js","sources":["../../../../src/UNSAFE_VirtualizedListView/__tests__/VirtualizedListView.spec.tsx"],"sourcesContent":["/**\n * General VirtualizedListView tests\n */\nimport { useRef, useState } from 'preact/hooks';\n\nimport { DataState, ListItemContext, Range } from '../../UNSAFE_Collection';\nimport { Flex } from '../../UNSAFE_Flex';\nimport { Keys } from '../../utils/UNSAFE_keys';\nimport { VirtualizedListView } from '..';\n\nimport { setupIntersectionObserverMock } from '../../../test/mocks/mockIntersectionObserver';\nimport * as ListTests from '../../PRIVATE_List/__tests__/shared/listViewTests';\nimport { testSelection } from '../../PRIVATE_List/__tests__/shared/listViewSelectionTests';\n\ntype Employee<K> = {\n  id: K;\n  name: string;\n};\n\ntype Props<K, D> = ListTests.Props<K, D>;\n\nfunction TestComponent<K extends string | number>({\n  currentItemVariant,\n  data,\n  initialKey,\n  gridlines,\n  onItemAction,\n  selectedKeys,\n  selectionMode\n}: Props<K, Employee<K>>) {\n  const rootRef = useRef(null);\n  const [currentKey, setCurrentKey] = useState<K | undefined>(initialKey);\n  const [selection, setSelection] = useState<Keys<K> | undefined>(selectedKeys);\n  const [dataState, setDataState] = useState<DataState<K, Employee<K>>>({\n    offset: 0,\n    data: data.slice(0, 25),\n    totalSize: data.length,\n    sizePrecision: 'exact'\n  });\n\n  const loadRange = (range: Range) => {\n    const startIndex = range.offset;\n    const endIndex = startIndex + range.count;\n    const newDataState = {\n      ...dataState,\n      offset: startIndex,\n      data: data.slice(startIndex, endIndex)\n    };\n    setDataState(newDataState);\n  };\n\n  const getConfig = () => {\n    return {\n      scroller: () => {\n        return rootRef.current;\n      }\n    };\n  };\n\n  return (\n    <div\n      style=\"height: calc(10 * var(--oj-c-PRIVATE-DO-NOT-USE-core-spacing-5x));overflow: auto\"\n      ref={rootRef}>\n      <VirtualizedListView\n        accessibleSummary=\"Basic list\"\n        data={dataState}\n        currentKey={currentKey}\n        selectedKeys={selection}\n        selectionMode={selectionMode}\n        viewportConfig={getConfig()}\n        onCurrentKeyChange={(detail) => setCurrentKey(detail.value)}\n        onSelectionChange={(detail) => setSelection(detail.value)}\n        onLoadRange={loadRange}\n        gridlines={gridlines}\n        onItemAction={onItemAction}\n        currentItemVariant={currentItemVariant}>\n        {(context: ListItemContext<K, Employee<K>>) => (\n          <Flex>\n            {context.selector && context.selector()}\n            <div\n              className=\"item\"\n              style={{\n                height: 'calc(var(--oj-c-PRIVATE-DO-NOT-USE-core-spacing-5x))',\n                padding: 'var(--oj-c-PRIVATE-DO-NOT-USE-core-spacing-3x)'\n              }}>\n              {context.data.name}\n            </div>\n          </Flex>\n        )}\n      </VirtualizedListView>\n    </div>\n  );\n}\n\ndescribe('Test VirtualizedListView component', () => {\n  beforeEach(() => {\n    if (!window.IntersectionObserver) {\n      setupIntersectionObserverMock();\n    }\n  });\n\n  // bind shared tests\n  ListTests.testRender.bind(this)(TestComponent);\n  ListTests.testAria.bind(this)(TestComponent);\n  ListTests.testKeys.bind(this)(TestComponent);\n  ListTests.testGridlines.bind(this)(TestComponent);\n  ListTests.testItemAction.bind(this)(TestComponent);\n\n  // selection tests\n  testSelection.bind(this)(TestComponent);\n});\n"],"names":["useRef","useState","_jsx","VirtualizedListView","_jsxs","Flex","setupIntersectionObserverMock","ListTests.testRender","this","ListTests.testAria","ListTests.testKeys","ListTests.testGridlines","ListTests.testItemAction","testSelection"],"mappings":"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"}