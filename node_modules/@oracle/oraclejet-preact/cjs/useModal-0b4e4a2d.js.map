{"version":3,"file":"useModal-0b4e4a2d.js","sources":["../../src/UNSAFE_Modal/hooks/useModal.ts"],"sourcesContent":["\nimport { useRef, useCallback, useEffect } from \"preact/compat\";\n\nexport type UseModalProps = Readonly<{\n    /**\n     * Determines whether the Modal is open.\n     */\n    isOpen : boolean;\n    /**\n     * On backdrop click callback.\n     */\n    onBackdropClick? : () => void;\n  }>;\n  \n  /**\n   *\n   * @param props\n   */\n  export const useModal = (props: UseModalProps) => {\n    \n    const {\n      isOpen,\n      onBackdropClick : onBackdropClickProp,\n    } = props;\n\n    const modalRef = useRef<HTMLDivElement>(null)\n\n    const mouseDownTarget = useRef<EventTarget | null>(null);\n\n    const onMouseDown = useCallback( (event: MouseEvent) => {\n        if (modalRef.current === event.target) {\n          mouseDownTarget.current = event.target\n        }\n      }, []);\n\n    const onBackdropClick = useCallback( (event: MouseEvent) => {\n      \n      if (modalRef.current === event.target) {\n        event.stopPropagation()\n        // event should originate on the same target\n        if (mouseDownTarget.current === event.target) {\n          onBackdropClickProp?.()\n        }\n      }\n    }, [onBackdropClickProp] )\n\n    useEffect(() => {\n      const modal = modalRef.current;\n\n      if (modal) {\n        modal.addEventListener('mousedown', onMouseDown);\n        modal.addEventListener('click', onBackdropClick); \n\n        return () => {\n          modal.removeEventListener('mousedown', onMouseDown);\n          modal.removeEventListener('click', onBackdropClick);\n        }\n      }\n\n      return () => {};\n    }, [isOpen, onMouseDown, onBackdropClick]);\n\n    return {\n      modalRef,\n    }\n\n  };\n  \n  export default useModal;\n  "],"names":["useRef","useCallback","useEffect"],"mappings":";;;;;AAcE;;;AAGG;AACU,MAAA,QAAQ,GAAG,CAAC,KAAoB,KAAI;IAE/C,MAAM,EACJ,MAAM,EACN,eAAe,EAAG,mBAAmB,GACtC,GAAG,KAAK,CAAC;AAEV,IAAA,MAAM,QAAQ,GAAGA,aAAM,CAAiB,IAAI,CAAC,CAAA;AAE7C,IAAA,MAAM,eAAe,GAAGA,aAAM,CAAqB,IAAI,CAAC,CAAC;AAEzD,IAAA,MAAM,WAAW,GAAGC,kBAAW,CAAE,CAAC,KAAiB,KAAI;AACnD,QAAA,IAAI,QAAQ,CAAC,OAAO,KAAK,KAAK,CAAC,MAAM,EAAE;AACrC,YAAA,eAAe,CAAC,OAAO,GAAG,KAAK,CAAC,MAAM,CAAA;AACvC,SAAA;KACF,EAAE,EAAE,CAAC,CAAC;AAET,IAAA,MAAM,eAAe,GAAGA,kBAAW,CAAE,CAAC,KAAiB,KAAI;AAEzD,QAAA,IAAI,QAAQ,CAAC,OAAO,KAAK,KAAK,CAAC,MAAM,EAAE;YACrC,KAAK,CAAC,eAAe,EAAE,CAAA;;AAEvB,YAAA,IAAI,eAAe,CAAC,OAAO,KAAK,KAAK,CAAC,MAAM,EAAE;AAC5C,gBAAA,mBAAmB,KAAnB,IAAA,IAAA,mBAAmB,KAAnB,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,mBAAmB,EAAI,CAAA;AACxB,aAAA;AACF,SAAA;AACH,KAAC,EAAE,CAAC,mBAAmB,CAAC,CAAE,CAAA;IAE1BC,gBAAS,CAAC,MAAK;AACb,QAAA,MAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC;AAE/B,QAAA,IAAI,KAAK,EAAE;AACT,YAAA,KAAK,CAAC,gBAAgB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;AACjD,YAAA,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;AAEjD,YAAA,OAAO,MAAK;AACV,gBAAA,KAAK,CAAC,mBAAmB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;AACpD,gBAAA,KAAK,CAAC,mBAAmB,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;AACtD,aAAC,CAAA;AACF,SAAA;AAED,QAAA,OAAO,MAAO,GAAC,CAAC;KACjB,EAAE,CAAC,MAAM,EAAE,WAAW,EAAE,eAAe,CAAC,CAAC,CAAC;IAE3C,OAAO;QACL,QAAQ;KACT,CAAA;AAEH;;;;;;;"}