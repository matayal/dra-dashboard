/**
 * @license
 * Copyright (c) 2014, 2023, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","preact/jsx-runtime","preact","ojs/ojthemeutils","ojs/ojlabel","ojs/ojcustomelement-utils","ojs/ojdomutils"],function(t,e,o,l,s,n,a){"use strict";function r(t){const s=function(t,e){let o=t;if(e>1){const s=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/,n=t.match(s),a=parseFloat(n[1]);switch(n[2]){case"vw":case"vmin":case"vmax":case"%":if(e>1){let s=l.parseJSONFromFontFamily("oj-form-layout-option-defaults").columnGap;o="calc((("+t+" / "+e+") - (("+s+" * ("+(e-1)+") * "+a/e/100+")))"}}}return o}(t.labelWidth,t.colspan),n="calc(100% - "+s+")",a={flexGrow:"0",flexShrink:"0",flexBasis:s,width:s,maxWidth:s},r={flexGrow:"1",flexShrink:"1",flexBasis:n,width:n,maxWidth:n};return Array.isArray(t.children)||(t.children.props.labelEdge="provided"),e.jsxs(o.Fragment,{children:[e.jsx("div",Object.assign({class:"oj-formlayout-inline-label",style:a},{children:e.jsx("oj-label",Object.assign({for:t.forid},{children:t.labelText}))})),e.jsx("div",Object.assign({class:"oj-formlayout-inline-value",style:r},{children:t.children}))]})}function i(t){return Array.isArray(t.children)||(t.children.props.labelEdge="provided"),e.jsxs(o.Fragment,{children:[e.jsx("oj-label",Object.assign({for:t.forid},{children:t.labelText})),t.children]})}function c(t){var l;let s,a=!1,c=t.children;if(c){const m=!Array.isArray(c);return m&&(s=n.ElementUtils.getUniqueId(c.props.id),String(null===(l=c.props.children)||void 0===l?void 0:l.type).toLowerCase().startsWith("oj-c-")&&(a=!0,c=c.props.children)),"start"!==t.labelEdge||a?"top"!==t.labelEdge||a?(m&&("inside"===t.labelEdge||a?(c.props.labelEdge=t.labelEdge,c.props.labelHint=t.labelText):c.props.labelEdge="none"),e.jsx(o.Fragment,{children:t.children})):e.jsx(i,Object.assign({forid:s},t)):e.jsx(r,Object.assign({forid:s},t))}return null}class m extends o.Component{render(t){let o="oj-flex-item";const l=this._getFullFlexItemWidth(this.props.colspan,this.props.totalColumns);let s={flexGrow:"1",flexShrink:"1",flexBasis:l,width:l,maxWidth:l};return"start"==this.props.labelEdge&&(s.display="flex"),"formLayout"===this.props.contentType&&(o+=" oj-formlayout-nested-formlayout"),e.jsx("div",Object.assign({class:o,style:s},{children:e.jsx(c,Object.assign({labelText:this.props.labelText,labelEdge:this.props.labelEdge,labelWidth:this.props.labelWidth,colspan:this.props.colspan,totalColumns:this.props.totalColumns},{children:this.props.children}))}),t.cellKey)}_getFullFlexItemWidth(t,e){if(t===e)return"100%";let o=(l.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}).columnGap,s=(this.props.totalColumns,"calc(((100% / "+e+") - (("+o+" * ("+(e-1)+") / "+e+")))");return t>1&&(s+=" * "+t+" + ("+o+" * "+(t-1)+")"),s+=")",s}}m.defaultProps={colspan:1,totalColumns:1,labelEdge:"inside",labelWidth:"33%",labelText:""};class u extends o.Component{render(t){this._columns=t.columns>0?t.columns:t.maxColumns;const o="oj-form-layout oj-formlayout-max-cols-"+this._columns,l=this._getColumnFormContent(t.formControls,t.columns);return e.jsx("div",Object.assign({class:o},{children:l}))}_getColumnFormContent(t,o){let s,n,a,r=[];for(const o of t)n="function"==typeof o.content?o.content():o.content,a=o.labelEdge,a||(this._themeDefault||(this._themeDefault=l.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),a=this._themeDefault.labelEdge),s=e.jsx(m,Object.assign({totalColumns:1,labelText:o.labelText,labelEdge:a,labelWidth:o.labelWidth,contentType:o.contentType,cellKey:o.key},{children:n})),r.push(e.jsx("div",Object.assign({class:"oj-flex","data-oj-internal":!0},{children:s})));const i=this._getColumnStyling(o);return e.jsx("div",Object.assign({class:i.formClassName,style:i.formStyle,"data-oj-context":!0,"data-oj-internal":!0},{children:r}))}_getColumnStyling(t){let e="oj-form";return this.props.readonly||(e+=" oj-enabled"),"efficient"===this.props.userAssistanceDensity&&(e+=" oj-efficient"),"truncate"===this.props.labelWrapping&&(e+=" oj-formlayout-labels-nowrap"),t>0&&(e+=" oj-form-layout-no-min-column-width"),e+=" oj-form-cols",{formClassName:e,formStyle:{columnCount:this._columns,webkitColumnCount:this._columns,MozColumnCount:this._columns}}}}u.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};class d extends o.Component{constructor(){super(...arguments),this.setFormDivRef=t=>{this.formDivRef=t},this.state={availableColumns:0},this._updateAvailableColumns=()=>{if(0===this._calculateColumns(0)){const t=this.formDivRef,e=t.class;t.class="oj-form-layout";const o=this._calculateAvailableColumns(t);t.class=e,this.state.availableColumns!==o&&this.setState({availableColumns:o})}}}render(t){const o="oj-form-layout oj-formlayout-max-cols-"+(t.columns>0?t.columns+" oj-form-layout-no-min-column-width":t.maxColumns),l=this._getRowFormContent(this.props.formControls);return e.jsx("div",Object.assign({class:o,ref:this.setFormDivRef},{children:l}))}componentDidMount(){this._updateAvailableColumns(),a.addResizeListener(this.formDivRef,this._updateAvailableColumns,25)}componentDidUpdate(){this._updateAvailableColumns()}componentWillUnmount(){a.removeResizeListener(this.formDivRef,this._updateAvailableColumns)}_calculateAvailableColumns(t){let e=Math.max(this.props.maxColumns,1),o=parseFloat(window.getComputedStyle(t.querySelector(".oj-form")).columnWidth);if(!isNaN(o)){let t=this.formDivRef.getBoundingClientRect().width;e=Math.max(Math.floor(t/o),1)}return e}_calculateColumns(t){let e=Math.max(this.props.maxColumns,1);const o=this.props.columns;return o>0?e=o:e>1&&t<e&&(e=t),e}_getRowFormContent(t){let o,s=[];const n=this._calculateColumns(this.state.availableColumns);0===n&&(t=[]);let a,r,i,c,u=0,d=!1;for(const p of t){if(a=1,r=n,i="function"==typeof p.content?p.content():p.content,u%n==0&&(o&&this._addRowToForm(s,o,u),o=[]),p.colspan&&p.colspan>1){const t=u%n;let e=n-t;a=Math.floor(p.colspan),"wrap"===this.props.colspanWrap&&e<a&&t>0&&(this._addRowToForm(s,o,u),u+=e,o=[],e=n),a=Math.min(a,e),d=n>1}c=p.labelEdge,c||(this._themeDefault||(this._themeDefault=l.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),c=this._themeDefault.labelEdge),o.push(e.jsx(m,Object.assign({colspan:a,totalColumns:r,labelText:p.labelText,labelEdge:c,labelWidth:p.labelWidth,contentType:p.contentType,cellKey:p.key},{children:i}))),u+=a,u%n!=0&&this._addColumnGutter(o)}this._addRowToForm(s,o,u);const p=this._getRowStyling(d);return e.jsx("div",Object.assign({class:p.formClassName,style:p.formStyle,"data-oj-context":!0,"data-oj-internal":!0},{children:s}))}_addColumnGutter(t){t.push(e.jsx("div",{class:"oj-formlayout-column-gutter"}))}_addRowToForm(t,o,l){this._addPaddingCells(o,l),t.push(e.jsx("div",Object.assign({class:"oj-flex","data-oj-internal":!0},{children:o})))}_addPaddingCells(t,o){const l=this._calculateColumns(this.state.availableColumns)||this.props.maxColumns,s=o%l;if(t&&s>0)for(let o=s;o<l;o++)o!==s&&this._addColumnGutter(t),t.push(e.jsx(m,{colspan:1,totalColumns:l,labelEdge:"none"}))}_getRowStyling(t){let e="oj-form";this.props.readonly||(e+=" oj-enabled"),"efficient"===this.props.userAssistanceDensity&&(e+=" oj-efficient"),"truncate"===this.props.labelWrapping&&(e+=" oj-formlayout-labels-nowrap"),t&&(e+=" oj-form-control-full-width"),e+=" oj-form-cols";return e+=" oj-formlayout-form-across",{formClassName:e,formStyle:{columnCount:1,webkitColumnCount:1,MozColumnCount:1}}}}d.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};var p=function(t,e){var o={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(o[l]=t[l]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(t);s<l.length;s++)e.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(t,l[s])&&(o[l[s]]=t[l[s]])}return o};class h extends o.Component{render(t){const{direction:o}=t,l=p(t,["direction"]);return"column"===o?e.jsx(u,Object.assign({},l)):e.jsx(d,Object.assign({},l))}}h.defaultProps={colspanWrap:"nowrap",direction:"row",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"},t.VFormGenerator=h,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojvformgenerator.js.map